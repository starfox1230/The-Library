<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Leukodystrophies + MELAS/Leigh — Image Search Gallery</title>
  <style>
    :root{
      --bg0:#070A10;
      --bg1:#0B1220;
      --card:#0E1830;
      --card2:#0B1428;
      --text:#EAF0FF;
      --muted:#A7B3D6;
      --line:rgba(255,255,255,0.08);
      --glow:rgba(120,180,255,0.22);
      --accent:rgba(120,180,255,0.95);
      --good:rgba(120,255,180,0.9);
      --warn:rgba(255,200,120,0.95);
      --bad:rgba(255,120,140,0.95);
      --shadow: 0 18px 45px rgba(0,0,0,0.45);
      --radius:18px;
      --radius2:14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family:var(--sans);
      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(120,180,255,0.12), transparent 50%),
        radial-gradient(900px 700px at 80% 20%, rgba(160,120,255,0.10), transparent 55%),
        radial-gradient(1100px 900px at 50% 95%, rgba(120,255,180,0.06), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    a{color:inherit}
    .wrap{max-width:1200px;margin:0 auto;padding:20px 18px 60px}

    .topbar{
      position:sticky; top:0; z-index:50;
      padding:14px 0 12px;
      backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(7,10,16,0.92), rgba(7,10,16,0.55));
      border-bottom:1px solid var(--line);
    }

    header{
      display:flex; align-items:flex-end; justify-content:space-between;
      gap:14px; padding:10px 0 4px;
    }
    h1{
      margin:0;
      font-size:20px; font-weight:780; letter-spacing:0.2px;
    }
    .sub{
      margin:6px 0 0;
      font-size:12.5px; color:var(--muted); line-height:1.35;
      max-width:760px;
    }

    .controls{
      display:grid;
      grid-template-columns: 1.2fr 0.9fr 0.9fr;
      gap:10px;
      margin-top:12px;
    }
    .control{
      background: rgba(14,24,48,0.72);
      border:1px solid var(--line);
      border-radius: var(--radius2);
      padding:10px 12px;
      box-shadow: 0 0 0 1px rgba(120,180,255,0.05) inset;
    }
    .label{
      font-size:11px;
      color:var(--muted);
      margin-bottom:6px;
      letter-spacing:0.25px;
      text-transform:uppercase;
    }
    input[type="text"], select{
      width:100%;
      background: rgba(0,0,0,0.16);
      border:1px solid rgba(255,255,255,0.10);
      color:var(--text);
      border-radius:12px;
      padding:10px 11px;
      outline:none;
      font-size:14px;
    }
    input[type="text"]::placeholder{color:rgba(167,179,214,0.7)}
    select{appearance:none}

    .toggles{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .toggle{
      display:flex; align-items:center; gap:9px;
      user-select:none;
      cursor:pointer;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.14);
    }
    .toggle input{accent-color: rgb(120,180,255)}
    .toggle span{
      font-size:13px;
      color:var(--text);
    }

    .stats{
      font-size:12px; color:var(--muted);
      display:flex; align-items:center; gap:10px;
      justify-content:flex-end;
      white-space:nowrap;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:14px;
      margin-top:18px;
    }

    .section{
      grid-column:1/-1;
      border:1px solid var(--line);
      border-radius: var(--radius);
      overflow:hidden;
      background: linear-gradient(180deg, rgba(14,24,48,0.72), rgba(11,20,40,0.66));
      box-shadow: var(--shadow);
    }

    .sectionHead{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px;
      padding:14px 14px;
      border-bottom:1px solid var(--line);
      background:
        radial-gradient(700px 120px at 18% 0%, rgba(120,180,255,0.18), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.0));
      cursor:pointer;
      user-select:none;
    }

    .sectionTitle{
      display:flex; align-items:baseline; gap:10px; flex-wrap:wrap;
    }
    .sectionTitle strong{font-size:15px; letter-spacing:0.2px}
    .chip{
      font-size:11px;
      color:rgba(234,240,255,0.88);
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.16);
      padding:4px 8px;
      border-radius:999px;
    }
    .chev{
      width:34px;height:34px;border-radius:12px;
      display:grid;place-items:center;
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.14);
    }
    .chev svg{transition:transform 180ms ease}
    .section[data-open="true"] .chev svg{transform:rotate(180deg)}

    .cards{
      padding:14px;
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:12px;
    }

    .card{
      grid-column: span 6;
      border:1px solid rgba(255,255,255,0.10);
      border-radius: var(--radius2);
      background: linear-gradient(180deg, rgba(14,24,48,0.70), rgba(11,20,40,0.62));
      overflow:hidden;
      box-shadow: 0 0 0 1px rgba(120,180,255,0.04) inset;
      position:relative;
    }
    .card::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(500px 200px at 30% 0%, var(--glow), transparent 60%);
      pointer-events:none;
      opacity:0.6;
    }

    .cardTop{
      position:relative;
      padding:12px 12px 10px;
      border-bottom:1px solid rgba(255,255,255,0.08);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }

    .cardTitle{
      margin:0;
      font-size:13.5px;
      line-height:1.25;
      font-weight:720;
    }
    .cardMeta{
      margin-top:6px;
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      color:var(--muted);
      font-size:12px;
    }
    .tag{
      font-family: var(--mono);
      font-size:11px;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.16);
      padding:3px 8px;
      border-radius:999px;
      color:rgba(234,240,255,0.86);
    }
    .tag.mri{outline:1px solid rgba(120,180,255,0.22)}
    .tag.ct{outline:1px solid rgba(255,200,120,0.22)}
    .tag.mrs{outline:1px solid rgba(160,120,255,0.22)}
    .tag.misc{outline:1px solid rgba(255,255,255,0.12)}
    .tag.finding{outline:1px solid rgba(120,255,180,0.18)}

    .cardBtns{
      display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end;
      min-width:160px;
    }
    button, .btnLink{
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.18);
      color:rgba(234,240,255,0.92);
      padding:8px 10px;
      border-radius:12px;
      font-size:12px;
      cursor:pointer;
      transition: transform 120ms ease, border-color 120ms ease, background 120ms ease;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
      white-space:nowrap;
    }
    button:hover, .btnLink:hover{
      transform: translateY(-1px);
      border-color: rgba(120,180,255,0.35);
      background: rgba(120,180,255,0.10);
    }
    button:active, .btnLink:active{transform: translateY(0px)}
    .btnPrimary{
      border-color: rgba(120,180,255,0.35);
      background: rgba(120,180,255,0.12);
    }
    .btnDanger{
      border-color: rgba(255,120,140,0.28);
      background: rgba(255,120,140,0.08);
    }

    .preview{
      position:relative;
      height: 340px;
      background: rgba(0,0,0,0.14);
    }
    .preview iframe{
      width:100%;
      height:100%;
      border:0;
      background: rgba(0,0,0,0.10);
    }
    .previewOverlay{
      position:absolute; inset:0;
      display:grid; place-items:center;
      padding:16px;
      text-align:center;
      color:rgba(234,240,255,0.92);
      background:
        radial-gradient(600px 280px at 40% 20%, rgba(120,180,255,0.14), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,0.14), rgba(0,0,0,0.30));
      border-top:1px solid rgba(255,255,255,0.06);
    }
    .overlayBox{
      max-width:420px;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(0,0,0,0.22);
      border-radius:16px;
      padding:12px 14px;
      box-shadow: 0 0 0 1px rgba(120,180,255,0.04) inset;
    }
    .overlayBox .hint{
      margin-top:6px;
      font-size:12px;
      color:var(--muted);
      line-height:1.35;
    }

    .hidden{display:none !important;}

    @media (max-width: 980px){
      .controls{grid-template-columns: 1fr}
      .card{grid-column: span 12}
      .preview{height: 380px}
      .stats{justify-content:flex-start}
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="wrap">
      <header>
        <div>
          <h1>Leukodystrophies + MELAS/Leigh — Image Search Gallery</h1>
          <div class="sub">
            Click “Preview” to load an embedded Google Images search, or “Open” to view it in a new tab.
            Note: Google sometimes blocks iframe embedding; if a preview is blank, use “Open”.
          </div>
        </div>
        <div class="stats" id="stats"></div>
      </header>

      <div class="controls">
        <div class="control">
          <div class="label">Filter</div>
          <input id="filterInput" type="text" placeholder="Type to filter (e.g., 'tigroid', 'DWI', 'Krabbe', 'thalamus')" />
        </div>

        <div class="control">
          <div class="label">Section</div>
          <select id="sectionSelect"></select>
        </div>

        <div class="control">
          <div class="label">Options</div>
          <div class="toggles">
            <label class="toggle" title="If on, all previews load automatically (heavier).">
              <input id="autoLoad" type="checkbox" />
              <span>Auto-load previews</span>
            </label>
            <label class="toggle" title="Collapse all sections (useful after filtering).">
              <input id="collapseAll" type="checkbox" />
              <span>Collapse all</span>
            </label>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="wrap">
    <div class="grid" id="grid"></div>
  </div>

<script>
  // Data: each item is one pathology / sign / imaging finding with its own Google Images search.
  var SECTIONS = [
    {
      "id":"general",
      "title":"Leukodystrophy — General",
      "subtitle":"Core pattern recognition (peds symmetric WM)",
      "items":[
        {"label":"Leukodystrophy (peds symmetric white matter) — MRI FLAIR","query":"leukodystrophy MRI FLAIR pediatric symmetric white matter"},
        {"label":"Symmetric extensive white matter abnormality — MRI FLAIR","query":"symmetric extensive white matter abnormality MRI FLAIR"}
      ]
    },
    {
      "id":"ald",
      "title":"Adrenoleukodystrophy (ALD) — X-linked",
      "subtitle":"Posterior predominance + callosal splenium extension; may enhance/restrict",
      "items":[
        {"label":"X-linked adrenoleukodystrophy — MRI FLAIR","query":"x-linked adrenoleukodystrophy MRI FLAIR"},
        {"label":"Parieto-occipital predominance in ALD — MRI FLAIR","query":"parieto-occipital predominance adrenoleukodystrophy MRI FLAIR"},
        {"label":"Splenium corpus callosum involvement in ALD — MRI","query":"splenium corpus callosum involvement adrenoleukodystrophy MRI"},
        {"label":"ALD contrast enhancement — post-contrast T1 MRI","query":"adrenoleukodystrophy contrast enhancement post-contrast T1 MRI"},
        {"label":"ALD restricted diffusion — DWI MRI","query":"adrenoleukodystrophy restricted diffusion DWI MRI"}
      ]
    },
    {
      "id":"mld",
      "title":"Metachromatic leukodystrophy (MLD)",
      "subtitle":"Frontal predominance; periventricular/deep WM; tigroid pattern; U-fibers relatively spared",
      "items":[
        {"label":"Metachromatic leukodystrophy — MRI FLAIR","query":"metachromatic leukodystrophy MRI FLAIR"},
        {"label":"Frontal predominance in MLD — MRI FLAIR","query":"frontal predominance metachromatic leukodystrophy MRI FLAIR"},
        {"label":"Periventricular WM involvement in MLD — MRI FLAIR","query":"periventricular white matter metachromatic leukodystrophy MRI FLAIR"},
        {"label":"Deep WM involvement in MLD — MRI FLAIR","query":"deep white matter metachromatic leukodystrophy MRI FLAIR"},
        {"label":"Tigroid pattern (MLD) — MRI","query":"tigroid pattern metachromatic leukodystrophy MRI"},
        {"label":"Subcortical U-fiber sparing (MLD) — MRI","query":"subcortical U-fiber sparing metachromatic leukodystrophy MRI"}
      ]
    },
    {
      "id":"alexander",
      "title":"Alexander disease",
      "subtitle":"Frontal predominance; macrocephaly; can involve cerebellum/MCPs; can enhance",
      "items":[
        {"label":"Alexander disease — MRI FLAIR","query":"alexander disease leukodystrophy MRI FLAIR"},
        {"label":"Frontal predominance (Alexander) — MRI FLAIR","query":"frontal predominance alexander disease MRI FLAIR"},
        {"label":"Macrocephaly (Alexander) — imaging","query":"macrocephaly alexander disease imaging"},
        {"label":"Cerebellar involvement (Alexander) — MRI","query":"alexander disease cerebellum involvement MRI"},
        {"label":"Middle cerebellar peduncle involvement (Alexander) — MRI","query":"alexander disease middle cerebellar peduncle MRI"},
        {"label":"Contrast enhancement (Alexander) — post-contrast MRI","query":"alexander disease contrast enhancement post-contrast MRI"}
      ]
    },
    {
      "id":"canavan",
      "title":"Canavan disease",
      "subtitle":"Diffuse bilateral subcortical U-fiber involvement; macrocephaly; elevated NAA on MRS",
      "items":[
        {"label":"Canavan disease — MRI FLAIR","query":"canavan disease MRI FLAIR"},
        {"label":"Diffuse bilateral subcortical U-fiber involvement (Canavan) — MRI","query":"diffuse bilateral subcortical U-fiber involvement Canavan MRI"},
        {"label":"Macrocephaly (Canavan) — imaging","query":"macrocephaly Canavan disease imaging"},
        {"label":"Elevated NAA (Canavan) — MR spectroscopy","query":"elevated NAA Canavan disease MR spectroscopy"}
      ]
    },
    {
      "id":"krabbe",
      "title":"Krabbe disease",
      "subtitle":"Parieto-occipital predominance; early U-fiber sparing; CT hyperdensity in deep gray/deep WM",
      "items":[
        {"label":"Krabbe disease — MRI FLAIR","query":"Krabbe disease MRI FLAIR"},
        {"label":"Microcephaly (Krabbe) — imaging","query":"microcephaly Krabbe disease imaging"},
        {"label":"Centrum semiovale involvement (Krabbe) — MRI","query":"centrum semiovale Krabbe disease MRI"},
        {"label":"Periventricular WM involvement (Krabbe) — MRI FLAIR","query":"periventricular white matter Krabbe disease MRI FLAIR"},
        {"label":"Parieto-occipital predominance (Krabbe) — MRI FLAIR","query":"parieto-occipital predominance Krabbe disease MRI FLAIR"},
        {"label":"Hyperdense thalamus (Krabbe) — CT","query":"Krabbe disease CT hyperdense thalamus"},
        {"label":"Hyperdense caudate (Krabbe) — CT","query":"Krabbe disease CT hyperdense caudate"},
        {"label":"Deep WM hyperdensity (Krabbe) — CT","query":"Krabbe disease CT deep white matter hyperdensity"},
        {"label":"Early subcortical U-fiber sparing (Krabbe) — MRI","query":"early subcortical U-fiber sparing Krabbe disease MRI"}
      ]
    },
    {
      "id":"pm",
      "title":"Pelizaeus–Merzbacher disease",
      "subtitle":"Hypomyelination (“total lack of normal myelination”); can be tigroid; no enhancement or restriction",
      "items":[
        {"label":"Pelizaeus–Merzbacher disease — MRI","query":"Pelizaeus-Merzbacher disease MRI"},
        {"label":"Hypomyelination (Pelizaeus–Merzbacher) — MRI","query":"Pelizaeus-Merzbacher hypomyelination MRI"},
        {"label":"Subcortical U-fiber involvement (hypomyelination) — MRI","query":"subcortical U-fiber involvement hypomyelination MRI"},
        {"label":"Tigroid pattern (Pelizaeus–Merzbacher) — MRI","query":"tigroid pattern Pelizaeus-Merzbacher MRI"},
        {"label":"No enhancement (Pelizaeus–Merzbacher) — post-contrast MRI","query":"Pelizaeus-Merzbacher no enhancement post-contrast MRI"},
        {"label":"No restricted diffusion (Pelizaeus–Merzbacher) — DWI MRI","query":"Pelizaeus-Merzbacher no restricted diffusion DWI MRI"}
      ]
    },
    {
      "id":"melas",
      "title":"MELAS",
      "subtitle":"Parieto-occipital distribution; “migrating infarcts”; MRS: lactate↑, NAA↓",
      "items":[
        {"label":"MELAS — MRI","query":"MELAS MRI"},
        {"label":"Parieto-occipital distribution (MELAS) — MRI FLAIR","query":"parieto-occipital distribution MELAS MRI FLAIR"},
        {"label":"“Migrating infarcts” (MELAS) — DWI MRI","query":"migrating infarcts MELAS MRI DWI"},
        {"label":"MELAS MRS pattern: lactate↑, NAA↓ — MR spectroscopy","query":"MELAS MR spectroscopy increased lactate decreased NAA"},
        {"label":"Increased lactate peak (MELAS) — MR spectroscopy","query":"increased lactate peak MELAS MR spectroscopy"},
        {"label":"Decreased NAA (MELAS) — MR spectroscopy","query":"decreased NAA MELAS MR spectroscopy"}
      ]
    },
    {
      "id":"leigh",
      "title":"Leigh disease (subacute necrotizing encephalo-myelopathy)",
      "subtitle":"Basal ganglia + periaqueductal gray; focal subcortical WM; head size often normal",
      "items":[
        {"label":"Leigh disease — MRI","query":"Leigh disease MRI"},
        {"label":"Basal ganglia involvement (Leigh) — T2 MRI","query":"Leigh disease basal ganglia MRI T2"},
        {"label":"Periaqueductal gray involvement (Leigh) — MRI","query":"Leigh disease periaqueductal gray MRI"},
        {"label":"Focal subcortical WM lesions (Leigh) — MRI FLAIR","query":"Leigh disease focal subcortical white matter lesions MRI FLAIR"},
        {"label":"Normal head size (Leigh) — imaging","query":"Leigh disease normal head size imaging"}
      ]
    }
  ];

  function googleImagesUrlFromQuery(q){
    return "https://www.google.com/search?tbm=isch&q=" + encodeURIComponent(q);
  }

  function modalityTagFromQuery(q){
    var s = q.toLowerCase();
    if (s.includes("ct")) return {"text":"CT","cls":"ct"};
    if (s.includes("mr spectroscopy") || s.includes("mrs") || s.includes("spectroscopy")) return {"text":"MRS","cls":"mrs"};
    if (s.includes("dwi")) return {"text":"MRI DWI","cls":"mri"};
    if (s.includes("flair")) return {"text":"MRI FLAIR","cls":"mri"};
    if (s.includes("t2")) return {"text":"MRI T2","cls":"mri"};
    if (s.includes("post-contrast") || s.includes("t1")) return {"text":"MRI T1+C","cls":"mri"};
    if (s.includes("mri")) return {"text":"MRI","cls":"mri"};
    return {"text":"Imaging","cls":"misc"};
  }

  function el(tag, attrs, children){
    var n = document.createElement(tag);
    if (attrs){
      Object.keys(attrs).forEach(function(k){
        if (k === "class") n.className = attrs[k];
        else if (k === "html") n.innerHTML = attrs[k];
        else n.setAttribute(k, attrs[k]);
      });
    }
    (children || []).forEach(function(c){
      if (typeof c === "string") n.appendChild(document.createTextNode(c));
      else n.appendChild(c);
    });
    return n;
  }

  function build(){
    var grid = document.getElementById("grid");
    grid.innerHTML = "";

    var sectionSelect = document.getElementById("sectionSelect");
    sectionSelect.innerHTML = "";
    sectionSelect.appendChild(el("option", {"value":"all"}, ["All sections"]));
    SECTIONS.forEach(function(sec){
      sectionSelect.appendChild(el("option", {"value":sec.id}, [sec.title]));
    });

    SECTIONS.forEach(function(sec){
      var total = sec.items.length;

      var section = el("div", {"class":"section", "data-section-id":sec.id, "data-open":"true"}, []);
      var head = el("div", {"class":"sectionHead"}, []);
      var left = el("div", {"class":"sectionTitle"}, [
        el("strong", {}, [sec.title]),
        el("span", {"class":"chip"}, [total + " searches"]),
        el("span", {"class":"chip"}, [sec.subtitle])
      ]);

      var chev = el("div", {"class":"chev", "title":"Collapse/expand"}, [
        el("svg", {"width":"16","height":"16","viewBox":"0 0 24 24","fill":"none","xmlns":"http://www.w3.org/2000/svg"}, [
          el("path", {"d":"M6 9l6 6 6-6","stroke":"rgba(234,240,255,0.9)","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}, [])
        ])
      ]);

      head.appendChild(left);
      head.appendChild(chev);

      var cards = el("div", {"class":"cards"}, []);

      sec.items.forEach(function(item, idx){
        var url = googleImagesUrlFromQuery(item.query);
        var mod = modalityTagFromQuery(item.query);

        var card = el("div", {"class":"card", "data-label":item.label.toLowerCase(), "data-query":item.query.toLowerCase(), "data-url":url}, []);

        var top = el("div", {"class":"cardTop"}, []);
        var titleBox = el("div", {}, [
          el("div", {"class":"cardTitle"}, [item.label]),
          el("div", {"class":"cardMeta"}, [
            el("span", {"class":"tag " + mod.cls}, [mod.text]),
            el("span", {"class":"tag finding"}, ["Search"]),
            el("span", {"class":"tag misc"}, ["#" + (idx+1)])
          ])
        ]);

        var btns = el("div", {"class":"cardBtns"}, []);
        var open = el("a", {"class":"btnLink", "href":url, "target":"_blank", "rel":"noopener noreferrer"}, ["Open"]);
        var previewBtn = el("button", {"class":"btnPrimary", "type":"button"}, ["Preview"]);
        var copyBtn = el("button", {"type":"button"}, ["Copy query"]);
        var clearBtn = el("button", {"class":"btnDanger", "type":"button"}, ["Clear"]);

        btns.appendChild(open);
        btns.appendChild(previewBtn);
        btns.appendChild(copyBtn);
        btns.appendChild(clearBtn);

        top.appendChild(titleBox);
        top.appendChild(btns);

        var preview = el("div", {"class":"preview"}, []);
        var iframe = el("iframe", {
          "title": item.label,
          "loading":"lazy",
          "referrerpolicy":"no-referrer",
          "sandbox":"allow-scripts allow-same-origin allow-forms allow-popups"
        }, []);
        iframe.dataset.loaded = "false";

        var overlay = el("div", {"class":"previewOverlay"}, [
          el("div", {"class":"overlayBox"}, [
            el("div", {"style":"font-weight:740;font-size:13px;"}, ["Preview is off"]),
            el("div", {"class":"hint"}, [
              "Click ",
              el("span", {"style":"font-family:var(--mono);color:rgba(234,240,255,0.95)"}, ["Preview"]),
              " to load the embedded Google Images search. If the embed is blocked, use ",
              el("span", {"style":"font-family:var(--mono);color:rgba(234,240,255,0.95)"}, ["Open"]),
              "."
            ])
          ])
        ]);

        preview.appendChild(iframe);
        preview.appendChild(overlay);

        function loadIframe(){
          if (iframe.dataset.loaded === "true") return;
          iframe.src = url;
          iframe.dataset.loaded = "true";
          overlay.classList.add("hidden");
        }

        function clearIframe(){
          iframe.removeAttribute("src");
          iframe.dataset.loaded = "false";
          overlay.classList.remove("hidden");
        }

        previewBtn.addEventListener("click", function(){
          loadIframe();
        });

        clearBtn.addEventListener("click", function(){
          clearIframe();
        });

        copyBtn.addEventListener("click", function(){
          navigator.clipboard.writeText(item.query).catch(function(){});
          copyBtn.textContent = "Copied";
          setTimeout(function(){ copyBtn.textContent = "Copy query"; }, 900);
        });

        card.appendChild(top);
        card.appendChild(preview);
        cards.appendChild(card);

        // Auto-load support
        card._load = loadIframe;
        card._clear = clearIframe;
      });

      section.appendChild(head);
      section.appendChild(cards);

      head.addEventListener("click", function(e){
        // Avoid toggling when clicking buttons/links
        var t = e.target;
        if (t.tagName === "BUTTON" || t.tagName === "A" || (t.closest && t.closest("button,a"))) return;
        var open = section.getAttribute("data-open") === "true";
        section.setAttribute("data-open", open ? "false" : "true");
        cards.style.display = open ? "none" : "grid";
      });

      grid.appendChild(section);
    });

    applyFilters();
  }

  function applyFilters(){
    var filterVal = (document.getElementById("filterInput").value || "").trim().toLowerCase();
    var secVal = document.getElementById("sectionSelect").value;
    var collapse = document.getElementById("collapseAll").checked;
    var auto = document.getElementById("autoLoad").checked;

    var totalCards = 0;
    var shownCards = 0;
    var shownSections = 0;

    var sections = Array.from(document.querySelectorAll(".section"));
    sections.forEach(function(section){
      var sid = section.getAttribute("data-section-id");
      var cardsWrap = section.querySelector(".cards");
      var cards = Array.from(section.querySelectorAll(".card"));

      var sectionMatches = (secVal === "all" || sid === secVal);
      var anyShownInSection = false;

      cards.forEach(function(card){
        totalCards += 1;
        var hay = (card.getAttribute("data-label") + " " + card.getAttribute("data-query"));
        var match = sectionMatches && (filterVal === "" || hay.includes(filterVal));
        card.classList.toggle("hidden", !match);
        if (match){
          shownCards += 1;
          anyShownInSection = true;
          if (auto && card._load) card._load();
        } else {
          if (!auto && card._clear) card._clear();
        }
      });

      section.classList.toggle("hidden", !anyShownInSection);
      if (anyShownInSection) shownSections += 1;

      // Collapse behavior
      if (collapse){
        section.setAttribute("data-open","false");
        cardsWrap.style.display = "none";
      } else {
        section.setAttribute("data-open","true");
        cardsWrap.style.display = "grid";
      }
    });

    var stats = document.getElementById("stats");
    stats.textContent = shownCards + " / " + totalCards + " searches shown • " + shownSections + " section(s)";
  }

  document.addEventListener("DOMContentLoaded", function(){
    build();

    document.getElementById("filterInput").addEventListener("input", applyFilters);
    document.getElementById("sectionSelect").addEventListener("change", applyFilters);
    document.getElementById("collapseAll").addEventListener("change", applyFilters);

    document.getElementById("autoLoad").addEventListener("change", function(){
      // If turning off auto-load, do not forcibly clear; keep what user already opened.
      // But applyFilters will clear hidden cards when auto-load is off.
      applyFilters();
    });
  });
</script>
</body>
</html>
