<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Bible Project Copier</title>
  <style>
    :root {
      --bg: #121212;
      --card-bg: #1e1e1e;
      --text: #e0e0e0;
      --accent: #bb86fc;
      --input-bg: #272727;
      --input-border: #333;
      --radius: 8px;
      --spacing: 16px;
      --font: 16px;
    }
    *, *::before, *::after { box-sizing: border-box; }
    html, h1 { touch-action: manipulation; }
    body {
      margin: 0; padding: 0;
      background: var(--bg);
      color: var(--text);
      font: var(--font)/1.5 system-ui, sans-serif;
      height: 100vh;
      display: flex; align-items: center; justify-content: center;
    }
    .container {
      display: flex; flex-direction: column;
      padding: var(--spacing);
      max-width: 600px; width: 100%; height: 100%;
    }
    .title-nav {
      position: relative;
      margin-bottom: var(--spacing);
      text-align: center;
    }
    .title-nav h1 {
      margin: 0;
      font-size: 1.5rem;
      cursor: pointer;
      display: inline-block;
      user-select: none;
    }
    .dropdown-menu {
      display: none;
      position: absolute;
      top: calc(100% + 4px);
      left: 50%;
      transform: translateX(-50%);
      background: var(--card-bg);
      border: 1px solid var(--input-border);
      border-radius: var(--radius);
      box-shadow: 0 2px 8px rgba(0,0,0,0.5);
      z-index: 10;
      min-width: 160px;
    }
    .dropdown-menu a {
      display: block;
      padding: 10px 14px;
      color: var(--text);
      text-decoration: none;
      font-size: 0.95rem;
    }
    .dropdown-menu a:hover {
      background: var(--input-border);
    }
    .form-group {
      display: flex; flex-wrap: wrap;
      gap: var(--spacing);
      margin-bottom: var(--spacing);
    }
    .form-group > div {
      flex: 1 1 45%; min-width: 120px;
    }
    label {
      display: block; margin-bottom: 4px; font-weight: 500;
    }
    select {
      width: 100%; padding: 8px;
      background: var(--input-bg);
      color: var(--text);
      border: 1px solid var(--input-border);
      border-radius: var(--radius);
      font-size: 1rem;
    }
    .actions {
      display: flex; gap: 8px;
      margin-bottom: var(--spacing);
    }
    .actions button {
      flex: 1; padding: 12px;
      font-size: 1rem; font-weight: 500;
      color: var(--bg); background: var(--accent);
      border: none; border-radius: var(--radius);
      cursor: pointer;
    }
    .actions button:disabled {
      opacity: 0.4; cursor: not-allowed;
    }
    #video-links {
      margin-bottom: var(--spacing);
      text-align: center;
      font-size: 0.95rem;
      line-height: 1.4;
    }
    #video-links a {
      display: inline-block;
      margin: 0 4px 8px;
      padding: 4px 8px;
      color: var(--accent);
      background: var(--input-bg);
      border-radius: var(--radius);
      text-decoration: none;
      font-weight: 500;
    }
    #video-links a:hover {
      background: var(--input-border);
    }
    #scripture-text {
      flex: 1; width: 100%;
      padding: var(--spacing);
      background: var(--card-bg);
      color: var(--text);
      border: 1px solid var(--input-border);
      border-radius: var(--radius);
      resize: none; overflow-y: auto;
      font-size: 0.9rem; line-height: 1.4;
    }
    @media (min-width:600px) {
      .form-group { flex-wrap: nowrap; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="title-nav">
      <h1 id="dropdown-btn">Bible Project Copier ▾</h1>
      <div id="dropdown-menu" class="dropdown-menu">
        <a href="index.html">Scripture Copier</a>
        <a href="cfm.html">Come Follow Me</a>
      </div>
    </div>

    <div class="form-group">
      <div>
        <label for="volume">Volume</label>
        <select id="volume"></select>
      </div>
      <div>
        <label for="start-video">Start Video</label>
        <select id="start-video"></select>
      </div>
    </div>

    <div class="form-group">
      <div>
        <label for="end-video">End Video (optional)</label>
        <select id="end-video"></select>
      </div>
      <div aria-hidden="true"></div>
    </div>

    <div class="actions">
      <button id="fetch-btn">Fetch Transcript</button>
      <button id="copy-btn" disabled>Copy to Clipboard</button>
    </div>

    <div id="video-links" aria-live="polite"></div>

    <textarea id="scripture-text" readonly placeholder="Your transcript will appear here…"></textarea>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const ddTitle = document.getElementById('dropdown-btn');
    const ddMenu  = document.getElementById('dropdown-menu');
    ddTitle.addEventListener('click', e => {
      e.stopPropagation();
      ddMenu.style.display = ddMenu.style.display === 'block' ? 'none' : 'block';
    });
    document.addEventListener('click', () => {
      ddMenu.style.display = 'none';
    });

    const transcripts = {
      'old-testament': [
        { display: '00 - Old Testament Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/00 - Old Testament Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=ALsluAKBZ-c&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=1&t=307s&pp=iAQB0gcJCfwJAYcqIYzv' },
        { display: '01 - Book of Genesis Summary A Complete Animated Overview (Part 1)', path: 'bible-project-transcripts/old-testament/01 - Book of Genesis Summary A Complete Animated Overview (Part 1)', url: 'https://www.youtube.com/watch?v=GQI72THyO5I&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=2&pp=iAQB' },
        { display: '02 - Book of Genesis Summary A Complete Animated Overview (Part 2)', path: 'bible-project-transcripts/old-testament/02 - Book of Genesis Summary A Complete Animated Overview (Part 2)', url: 'https://www.youtube.com/watch?v=F4isSyennFo&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=3&pp=iAQB' },
        { display: '03 - Book of Exodus Summary A Complete Animated Overview (Part 1)', path: 'bible-project-transcripts/old-testament/03 - Book of Exodus Summary A Complete Animated Overview (Part 1)', url: 'https://www.youtube.com/watch?v=jH_aojNJM3E&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=4&pp=iAQB' },
        { display: '04 - Book of Exodus Summary A Complete Animated Overview (Part 2)', path: 'bible-project-transcripts/old-testament/04 - Book of Exodus Summary A Complete Animated Overview (Part 2)', url: 'https://www.youtube.com/watch?v=oNpTha80yyE&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=5&pp=iAQB' },
        { display: '05 - Book of Leviticus Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/05 - Book of Leviticus Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=IJ-FekWUZzE&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=6&pp=iAQB' },
        { display: '06 - Book of Numbers Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/06 - Book of Numbers Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=tp5MIrMZFqo&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=7&pp=iAQB0gcJCfwJAYcqIYzv' },
        { display: '07 - Book of Deuteronomy Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/07 - Book of Deuteronomy Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=q5QEH9bH8AU&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=8&t=309s&pp=iAQB' },
        { display: '08 - Book of Joshua Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/08 - Book of Joshua Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=JqOqJlFF_eU&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=9&t=66s&pp=iAQB' },
        { display: '09 - Book of Judges Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/09 - Book of Judges Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=kOYy8iCfIJ4&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=10&pp=iAQB' },
        { display: '10 - Book of Ruth Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/10 - Book of Ruth Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=0h1eoBeR4Jk&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=35&pp=iAQB' },
        { display: '11 - Book of 1 Samuel Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/11 - Book of 1 Samuel Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=QJOju5Dw0V0&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=11&pp=iAQB' },
        { display: '12 - Book of 2 Samuel Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/12 - Book of 2 Samuel Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=YvoWDXNDJgs&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=12&t=2s&pp=iAQB' },
        { display: '13 - Books of 1-2 Kings Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/13 - Books of 1-2 Kings Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=bVFW3wbi9pk&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=13&pp=iAQB' },
        { display: '14 - Books of 1-2 Chronicles Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/14 - Books of 1-2 Chronicles Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=HR7xaHv3Ias&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=41&pp=iAQB' },
        { display: '15 - Books of Ezra-Nehemiah Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/15 - Books of Ezra-Nehemiah Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=MkETkRv9tG8&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=40&pp=iAQB0gcJCfwJAYcqIYzv' },
        { display: '16 - Book of Esther Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/16 - Book of Esther Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=JydNSlufRIs&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=38&pp=iAQB' },
        { display: '17 - Book of Job Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/17 - Book of Job Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=xQwnH8th_fs&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=33&pp=iAQB' },
        { display: '18 - Book of Psalms Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/18 - Book of Psalms Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=j9phNEaPrv8&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=31&pp=iAQB' },
        { display: '19 - Book of Proverbs Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/19 - Book of Proverbs Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=AzmYV8GNAIM&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=32&pp=iAQB' },
        { display: '20 - Book of Ecclesiastes Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/20 - Book of Ecclesiastes Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=lrsQ1tc-2wk&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=37&pp=iAQB' },
        { display: '21 - Song of Songs Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/21 - Song of Songs Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=4KC7xE4fgOw&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=34&pp=iAQB' },
        { display: '22 - Book of Isaiah Summary A Complete Animated Overview (Part 1)', path: 'bible-project-transcripts/old-testament/22 - Book of Isaiah Summary A Complete Animated Overview (Part 1)', url: 'https://www.youtube.com/watch?v=d0A6Uchb1F8&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=14&pp=iAQB' },
        { display: '23 - Book of Isaiah Summary A Complete Animated Overview (Part 2)', path: 'bible-project-transcripts/old-testament/23 - Book of Isaiah Summary A Complete Animated Overview (Part 2)', url: 'https://www.youtube.com/watch?v=_TzdEPuqgQg&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=15&pp=iAQB' },
        { display: '24 - Book of Jeremiah Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/24 - Book of Jeremiah Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=RSK36cHbrk0&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=16&pp=iAQB' },
        { display: '25 - Book of Lamentations Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/25 - Book of Lamentations Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=p8GDFPdaQZQ&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=36&pp=iAQB' },
        { display: '26 - Book of Ezekiel Summary A Complete Animated Overview (Part 1)', path: 'bible-project-transcripts/old-testament/26 - Book of Ezekiel Summary A Complete Animated Overview (Part 1)', url: 'https://www.youtube.com/watch?v=R-CIPu1nko8&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=17&pp=iAQB' },
        { display: '27 - Book of Ezekiel Summary A Complete Animated Overview (Part 2)', path: 'bible-project-transcripts/old-testament/27 - Book of Ezekiel Summary A Complete Animated Overview (Part 2)', url: 'https://www.youtube.com/watch?v=SDeCWW_Bnyw&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=18&pp=iAQB' },
        { display: '28 - Book of Daniel Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/28 - Book of Daniel Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=9cSC9uobtPM&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=39&pp=iAQB' },
        { display: '29 - Book of Hosea Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/29 - Book of Hosea Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=kE6SZ1ogOVU&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=19&t=1s&pp=iAQB' },
        { display: '30 - Book of Joel Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/30 - Book of Joel Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=zQLazbgz90c&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=20&pp=iAQB' },
        { display: '31 - Book of Amos Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/31 - Book of Amos Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=mGgWaPGpGz4&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=21&pp=iAQB' },
        { display: '32 - Book of Obadiah Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/32 - Book of Obadiah Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=i4ogCrEoG5s&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=22&pp=iAQB' },
        { display: '33 - Book of Jonah Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/33 - Book of Jonah Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=dLIabZc0O4c&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=23&pp=iAQB' },
        { display: '34 - Book of Micah Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/34 - Book of Micah Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=MFEUEcylwLc&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=24&pp=iAQB0gcJCfwJAYcqIYzv' },
        { display: '35 - Book of Nahum Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/35 - Book of Nahum Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=Y30DanA5EhU&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=25&pp=iAQB' },
        { display: '36 - Book of Habakkuk Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/36 - Book of Habakkuk Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=OPMaRqGJPUU&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=26&pp=iAQB' },
        { display: '37 - Book of Zephaniah Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/37 - Book of Zephaniah Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=oFZknKPNvz8&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=27&pp=iAQB' },
        { display: '38 - Book of Haggai Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/38 - Book of Haggai Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=juPvv_xcX-U&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=28&pp=iAQB0gcJCfwJAYcqIYzv' },
        { display: '39 - Book of Zechariah Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/39 - Book of Zechariah Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=_106IfO6Kc0&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=29&pp=iAQB' },
        { display: '40 - Book of Malachi Summary A Complete Animated Overview', path: 'bible-project-transcripts/old-testament/40 - Book of Malachi Summary A Complete Animated Overview', url: 'https://www.youtube.com/watch?v=HPGShWZ4Jvk&list=PLH0Szn1yYNeeVFodkI9J_WEATHQCwRZ0u&index=30&pp=iAQB' }
      ],
      'new-testament': [
        { display: '01 - New Testament Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/01 - New Testament Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=Q0BrP8bqj0c&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=1&t=2s&pp=iAQB' },
        { display: '02 - Gospel of Matthew Summary A Complete Animated Overview (Part 1)', path: 'bible-project-transcripts/new-testament/02 - Gospel of Matthew Summary A Complete Animated Overview (Part 1).txt', url: 'https://www.youtube.com/watch?v=3Dv4-n6OYGI&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=2&t=232s&pp=iAQB' },
        { display: '03 - Gospel of Matthew Summary A Complete Animated Overview (Part 2)', path: 'bible-project-transcripts/new-testament/03 - Gospel of Matthew Summary A Complete Animated Overview (Part 2).txt', url: 'https://www.youtube.com/watch?v=GGCF3OPWN14&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=3&t=124s&pp=iAQB' },
        { display: '04 - Gospel of Mark Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/04 - Gospel of Mark Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=HGHqu9-DtXk&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=4&t=180s&pp=iAQB' },
        { display: '05 - Gospel of John Summary A Complete Animated Overview (Part 1)', path: 'bible-project-transcripts/new-testament/05 - Gospel of John Summary A Complete Animated Overview (Part 1).txt', url: 'https://www.youtube.com/watch?v=G-2e9mMf7E8&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=5&t=343s&pp=iAQB' },
        { display: '06 - Gospel of John Summary A Complete Animated Overview (Part 2)', path: 'bible-project-transcripts/new-testament/06 - Gospel of John Summary A Complete Animated Overview (Part 2).txt', url: 'https://www.youtube.com/watch?v=RUfh_wOsauk&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=6&pp=iAQB' },
        { display: '07 - Gospel of Luke Summary A Complete Animated Overview (Part 1)', path: 'bible-project-transcripts/new-testament/07 - Gospel of Luke Summary A Complete Animated Overview (Part 1).txt', url: 'https://www.youtube.com/watch?v=XIb_dCIxzr0&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=7&t=30s&pp=iAQB' },
        { display: '08 - Gospel of Luke Summary A Complete Animated Overview (Part 2)', path: 'bible-project-transcripts/new-testament/08 - Gospel of Luke Summary A Complete Animated Overview (Part 2).txt', url: 'https://www.youtube.com/watch?v=26z_KhwNdD8&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=8&pp=iAQB' },
        { display: '09 - Book of Acts Summary A Complete Animated Overview (Part 1)', path: 'bible-project-transcripts/new-testament/09 - Book of Acts Summary A Complete Animated Overview (Part 1).txt', url: 'https://www.youtube.com/watch?v=CGbNw855ksw&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=9&pp=iAQB' },
        { display: '10 - Book of Acts Summary A Complete Animated Overview (Part 2)', path: 'bible-project-transcripts/new-testament/10 - Book of Acts Summary A Complete Animated Overview (Part 2).txt', url: 'https://www.youtube.com/watch?v=Z-17KxpjL0Q&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=10&pp=iAQB' },
        { display: '11 - Book of Romans Summary A Complete Animated Overview (Part 1)', path: 'bible-project-transcripts/new-testament/11 - Book of Romans Summary A Complete Animated Overview (Part 1).txt', url: 'https://www.youtube.com/watch?v=ej_6dVdJSIU&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=11&pp=iAQB' },
        { display: '12 - Book of Romans Summary A Complete Animated Overview (Part 2)', path: 'bible-project-transcripts/new-testament/12 - Book of Romans Summary A Complete Animated Overview (Part 2).txt', url: 'https://www.youtube.com/watch?v=0SVTl4Xa5fY&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=12&pp=iAQB' },
        { display: '13 - Book of 1 Corinthians Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/13 - Book of 1 Corinthians Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=yiHf8klCCc4&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=13&pp=iAQB' },
        { display: '14 - Book of 2 Corinthians Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/14 - Book of 2 Corinthians Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=3lfPK2vfC54&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=14&pp=iAQB' },
        { display: '15 - Book of Galatians Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/15 - Book of Galatians Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=vmx4UjRFp0M&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=15&t=358s&pp=iAQB' },
        { display: '16 - Book of Ephesians Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/16 - Book of Ephesians Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=Y71r-T98E2Q&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=16&pp=iAQB0gcJCfwJAYcqIYzv' },
        { display: '17 - Book of Philippians Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/17 - Book of Philippians Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=oE9qqW1-BkU&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=17&pp=iAQB' },
        { display: '18 - Book of Colossians Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/18 - Book of Colossians Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=pXTXlDxQsvc&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=18&pp=iAQB0gcJCfwJAYcqIYzv' },
        { display: '19 - Book of 1 Thessalonians Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/19 - Book of 1 Thessalonians Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=No7Nq6IX23c&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=19&pp=iAQB' },
        { display: '20 - Book of 2 Thessalonians Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/20 - Book of 2 Thessalonians Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=kbPBDKOn1cc&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=20&pp=iAQB' },
        { display: '21 - Book of 1 Timothy Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/21 - Book of 1 Timothy Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=7RoqnGcEjcs&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=21&pp=iAQB' },
        { display: '22 - Book of 2 Timothy Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/22 - Book of 2 Timothy Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=urlvnxCaL00&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=22&pp=iAQB' },
        { display: '23 - Book of Titus Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/23 - Book of Titus Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=PUEYCVXJM3k&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=23&pp=iAQB' },
        { display: '24 - Book of Philemon Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/24 - Book of Philemon Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=aW9Q3Jt6Yvk&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=24&pp=iAQB0gcJCfwJAYcqIYzv' },
        { display: '25 - Book of Hebrews Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/25 - Book of Hebrews Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=1fNWTZZwgbs&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=25&pp=iAQB' },
        { display: '26 - Book of James Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/26 - Book of James Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=qn-hLHWwRYY&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=26&pp=iAQB' },
        { display: '27 - Book of 1 Peter Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/27 - Book of 1 Peter Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=WhP7AZQlzCg&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=27&pp=iAQB' },
        { display: '28 - Book of 2 Peter Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/28 - Book of 2 Peter Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=wWLv_ITyKYc&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=28&pp=iAQB' },
        { display: '29 - Books of 1-3 John Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/29 - Books of 1-3 John Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=l3QkE6nKylM&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=29&pp=iAQB' },
        { display: '30 - Book of Jude Summary A Complete Animated Overview', path: 'bible-project-transcripts/new-testament/30 - Book of Jude Summary A Complete Animated Overview.txt', url: 'https://www.youtube.com/watch?v=6UoCmakZmys&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=30&pp=iAQB' },
        { display: '31 - Book of Revelation Summary A Complete Animated Overview (Part 1)', path: 'bible-project-transcripts/new-testament/31 - Book of Revelation Summary A Complete Animated Overview (Part 1).txt', url: 'https://www.youtube.com/watch?v=5nvVVcYD-0w&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=31&pp=iAQB0gcJCfwJAYcqIYzv' },
        { display: '32 - Book of Revelation Summary A Complete Animated Overview (Part 2)', path: 'bible-project-transcripts/new-testament/32 - Book of Revelation Summary A Complete Animated Overview (Part 2).txt', url: 'https://www.youtube.com/watch?v=QpnIrbq2bKo&list=PLH0Szn1yYNecanpQqdixWAm3zHdhY2kPR&index=32&pp=iAQB' }
      ]
    };

    const volumeOrder = ['old-testament', 'new-testament'];

    const volSel      = document.getElementById('volume');
    const startVideo  = document.getElementById('start-video');
    const endVideo    = document.getElementById('end-video');
    const fetchBtn = document.getElementById('fetch-btn');
    const copyBtn  = document.getElementById('copy-btn');
    const outTA    = document.getElementById('scripture-text');
    const linkContainer = document.getElementById('video-links');

    const textCache = new Map();

    // ====== ADDED: 2026 CFM WEEK GUIDE FOR AUTO-SELECTION ======
    const cfmWeeks = [
      {"start":"2025-12-29","end":"2026-01-04","title":"Introduction to the Old Testament","readings":[]},
      {"start":"2026-01-05","end":"2026-01-11","title":"This Is My Work and My Glory","readings":[{"volume":"pearlofgreatprice","book":"moses","chapStart":1,"chapEnd":1,"linkBase":"pgp/moses","display":"Moses"},{"volume":"pearlofgreatprice","book":"abraham","chapStart":3,"chapEnd":3,"linkBase":"pgp/abr","display":"Abraham"}]},
      {"start":"2026-01-12","end":"2026-01-18","title":"In the Beginning God Created the Heaven and the Earth","readings":[{"volume":"oldtestament","book":"genesis","chapStart":1,"chapEnd":2,"linkBase":"ot/gen","display":"Genesis"},{"volume":"pearlofgreatprice","book":"moses","chapStart":2,"chapEnd":3,"linkBase":"pgp/moses","display":"Moses"},{"volume":"pearlofgreatprice","book":"abraham","chapStart":4,"chapEnd":5,"linkBase":"pgp/abr","display":"Abraham"}]},
      {"start":"2026-01-19","end":"2026-01-25","title":"The Fall of Adam and Eve","readings":[{"volume":"oldtestament","book":"genesis","chapStart":3,"chapEnd":4,"linkBase":"ot/gen","display":"Genesis"},{"volume":"pearlofgreatprice","book":"moses","chapStart":4,"chapEnd":5,"linkBase":"pgp/moses","display":"Moses"}]},
      {"start":"2026-01-26","end":"2026-02-01","title":"Teach These Things Freely unto Your Children","readings":[{"volume":"oldtestament","book":"genesis","chapStart":5,"chapEnd":5,"linkBase":"ot/gen","display":"Genesis"},{"volume":"pearlofgreatprice","book":"moses","chapStart":6,"chapEnd":6,"linkBase":"pgp/moses","display":"Moses"}]},
      {"start":"2026-02-02","end":"2026-02-08","title":"The Lord Called His People Zion","readings":[{"volume":"pearlofgreatprice","book":"moses","chapStart":7,"chapEnd":7,"linkBase":"pgp/moses","display":"Moses"}]},
      {"start":"2026-02-09","end":"2026-02-15","title":"Noah Found Grace in the Eyes of the Lord","readings":[{"volume":"oldtestament","book":"genesis","chapStart":6,"chapEnd":11,"linkBase":"ot/gen","display":"Genesis"},{"volume":"pearlofgreatprice","book":"moses","chapStart":8,"chapEnd":8,"linkBase":"pgp/moses","display":"Moses"}]},
      {"start":"2026-02-16","end":"2026-02-22","title":"To Be a Greater Follower of Righteousness","readings":[{"volume":"oldtestament","book":"genesis","chapStart":12,"chapEnd":17,"linkBase":"ot/gen","display":"Genesis"},{"volume":"pearlofgreatprice","book":"abraham","chapStart":1,"chapEnd":2,"linkBase":"pgp/abr","display":"Abraham"}]},
      {"start":"2026-02-23","end":"2026-03-01","title":"Is Any Thing Too Hard for the Lord?","readings":[{"volume":"oldtestament","book":"genesis","chapStart":18,"chapEnd":23,"linkBase":"ot/gen","display":"Genesis"}]},
      {"start":"2026-03-02","end":"2026-03-08","title":"Let God Prevail","readings":[{"volume":"oldtestament","book":"genesis","chapStart":24,"chapEnd":33,"linkBase":"ot/gen","display":"Genesis"}]},
      {"start":"2026-03-09","end":"2026-03-15","title":"The Lord Was with Joseph","readings":[{"volume":"oldtestament","book":"genesis","chapStart":37,"chapEnd":41,"linkBase":"ot/gen","display":"Genesis"}]},
      {"start":"2026-03-16","end":"2026-03-22","title":"God Meant It unto Good","readings":[{"volume":"oldtestament","book":"genesis","chapStart":42,"chapEnd":50,"linkBase":"ot/gen","display":"Genesis"}]},
      {"start":"2026-03-23","end":"2026-03-29","title":"I Have Remembered My Covenant","readings":[{"volume":"oldtestament","book":"exodus","chapStart":1,"chapEnd":6,"linkBase":"ot/ex","display":"Exodus"}]},
      {"start":"2026-03-30","end":"2026-04-05","title":"He Will Swallow Up Death in Victory","readings":[]},
      {"start":"2026-04-06","end":"2026-04-12","title":"Remember This Day, in Which Ye Came Out from Egypt","readings":[{"volume":"oldtestament","book":"exodus","chapStart":7,"chapEnd":13,"linkBase":"ot/ex","display":"Exodus"}]},
      {"start":"2026-04-13","end":"2026-04-19","title":"Stand Still, and See the Salvation of the Lord","readings":[{"volume":"oldtestament","book":"exodus","chapStart":14,"chapEnd":18,"linkBase":"ot/ex","display":"Exodus"}]},
      {"start":"2026-04-20","end":"2026-04-26","title":"All That the Lord Hath Spoken We Will Do","readings":[{"volume":"oldtestament","book":"exodus","chapStart":19,"chapEnd":20,"linkBase":"ot/ex","display":"Exodus"},{"volume":"oldtestament","book":"exodus","chapStart":24,"chapEnd":24,"linkBase":"ot/ex","display":"Exodus"},{"volume":"oldtestament","book":"exodus","chapStart":31,"chapEnd":34,"linkBase":"ot/ex","display":"Exodus"}]},
      {"start":"2026-04-27","end":"2026-05-03","title":"Holiness to the Lord","readings":[{"volume":"oldtestament","book":"exodus","chapStart":35,"chapEnd":40,"linkBase":"ot/ex","display":"Exodus"},{"volume":"oldtestament","book":"leviticus","chapStart":1,"chapEnd":1,"linkBase":"ot/lev","display":"Leviticus"},{"volume":"oldtestament","book":"leviticus","chapStart":4,"chapEnd":4,"linkBase":"ot/lev","display":"Leviticus"},{"volume":"oldtestament","book":"leviticus","chapStart":16,"chapEnd":16,"linkBase":"ot/lev","display":"Leviticus"},{"volume":"oldtestament","book":"leviticus","chapStart":19,"chapEnd":19,"linkBase":"ot/lev","display":"Leviticus"}]},
      {"start":"2026-05-04","end":"2026-05-10","title":"Rebel Not Ye against the Lord, Neither Fear","readings":[{"volume":"oldtestament","book":"numbers","chapStart":11,"chapEnd":14,"linkBase":"ot/num","display":"Numbers"},{"volume":"oldtestament","book":"numbers","chapStart":20,"chapEnd":24,"linkBase":"ot/num","display":"Numbers"},{"volume":"oldtestament","book":"numbers","chapStart":27,"chapEnd":27,"linkBase":"ot/num","display":"Numbers"}]},
      {"start":"2026-05-11","end":"2026-05-17","title":"Beware Lest Thou Forget the Lord","readings":[{"volume":"oldtestament","book":"deuteronomy","chapStart":6,"chapEnd":8,"linkBase":"ot/deut","display":"Deuteronomy"},{"volume":"oldtestament","book":"deuteronomy","chapStart":15,"chapEnd":15,"linkBase":"ot/deut","display":"Deuteronomy"},{"volume":"oldtestament","book":"deuteronomy","chapStart":18,"chapEnd":18,"linkBase":"ot/deut","display":"Deuteronomy"},{"volume":"oldtestament","book":"deuteronomy","chapStart":29,"chapEnd":30,"linkBase":"ot/deut","display":"Deuteronomy"},{"volume":"oldtestament","book":"deuteronomy","chapStart":34,"chapEnd":34,"linkBase":"ot/deut","display":"Deuteronomy"}]},
      {"start":"2026-05-18","end":"2026-05-24","title":"Be Strong and of a Good Courage","readings":[{"volume":"oldtestament","book":"joshua","chapStart":1,"chapEnd":8,"linkBase":"ot/josh","display":"Joshua"},{"volume":"oldtestament","book":"joshua","chapStart":23,"chapEnd":24,"linkBase":"ot/josh","display":"Joshua"}]},
      {"start":"2026-05-25","end":"2026-05-31","title":"The Lord Raised Up a Deliverer","readings":[{"volume":"oldtestament","book":"judges","chapStart":2,"chapEnd":4,"linkBase":"ot/judg","display":"Judges"},{"volume":"oldtestament","book":"judges","chapStart":6,"chapEnd":8,"linkBase":"ot/judg","display":"Judges"},{"volume":"oldtestament","book":"judges","chapStart":13,"chapEnd":16,"linkBase":"ot/judg","display":"Judges"}]},
      {"start":"2026-06-01","end":"2026-06-07","title":"My Heart Rejoiceth in the Lord","readings":[{"volume":"oldtestament","book":"ruth","chapStart":1,"chapEnd":4,"linkBase":"ot/ruth","display":"Ruth"},{"volume":"oldtestament","book":"1samuel","chapStart":1,"chapEnd":7,"linkBase":"ot/1-sam","display":"1 Samuel"}]},
      {"start":"2026-06-08","end":"2026-06-14","title":"The Lord Looketh on the Heart","readings":[{"volume":"oldtestament","book":"1samuel","chapStart":8,"chapEnd":10,"linkBase":"ot/1-sam","display":"1 Samuel"},{"volume":"oldtestament","book":"1samuel","chapStart":13,"chapEnd":13,"linkBase":"ot/1-sam","display":"1 Samuel"},{"volume":"oldtestament","book":"1samuel","chapStart":15,"chapEnd":16,"linkBase":"ot/1-sam","display":"1 Samuel"}]},
      {"start":"2026-06-15","end":"2026-06-21","title":"The Battle Is the Lord’s","readings":[{"volume":"oldtestament","book":"1samuel","chapStart":17,"chapEnd":18,"linkBase":"ot/1-sam","display":"1 Samuel"},{"volume":"oldtestament","book":"1samuel","chapStart":24,"chapEnd":26,"linkBase":"ot/1-sam","display":"1 Samuel"},{"volume":"oldtestament","book":"2samuel","chapStart":5,"chapEnd":7,"linkBase":"ot/2-sam","display":"2 Samuel"}]},
      {"start":"2026-06-22","end":"2026-06-28","title":"Hear Thou in Heaven Their Prayer","readings":[{"volume":"oldtestament","book":"2samuel","chapStart":11,"chapEnd":12,"linkBase":"ot/2-sam","display":"2 Samuel"},{"volume":"oldtestament","book":"1kings","chapStart":3,"chapEnd":3,"linkBase":"ot/1-kgs","display":"1 Kings"},{"volume":"oldtestament","book":"1kings","chapStart":6,"chapEnd":9,"linkBase":"ot/1-kgs","display":"1 Kings"},{"volume":"oldtestament","book":"1kings","chapStart":11,"chapEnd":11,"linkBase":"ot/1-kgs","display":"1 Kings"}]},
      {"start":"2026-06-29","end":"2026-07-05","title":"If the Lord Be God, Follow Him","readings":[{"volume":"oldtestament","book":"1kings","chapStart":12,"chapEnd":13,"linkBase":"ot/1-kgs","display":"1 Kings"},{"volume":"oldtestament","book":"1kings","chapStart":17,"chapEnd":22,"linkBase":"ot/1-kgs","display":"1 Kings"}]},
      {"start":"2026-07-06","end":"2026-07-12","title":"There Is a Prophet in Israel","readings":[{"volume":"oldtestament","book":"2kings","chapStart":2,"chapEnd":7,"linkBase":"ot/2-kgs","display":"2 Kings"}]},
      {"start":"2026-07-13","end":"2026-07-19","title":"He Trusted in the Lord God of Israel","readings":[{"volume":"oldtestament","book":"2kings","chapStart":16,"chapEnd":25,"linkBase":"ot/2-kgs","display":"2 Kings"}]},
      {"start":"2026-07-20","end":"2026-07-26","title":"Our Eyes Are upon Thee","readings":[{"volume":"oldtestament","book":"2chronicles","chapStart":14,"chapEnd":20,"linkBase":"ot/2-chr","display":"2 Chronicles"},{"volume":"oldtestament","book":"2chronicles","chapStart":26,"chapEnd":26,"linkBase":"ot/2-chr","display":"2 Chronicles"},{"volume":"oldtestament","book":"2chronicles","chapStart":30,"chapEnd":30,"linkBase":"ot/2-chr","display":"2 Chronicles"}]},
      {"start":"2026-07-27","end":"2026-08-02","title":"I Am Doing a Great Work","readings":[{"volume":"oldtestament","book":"ezra","chapStart":1,"chapEnd":1,"linkBase":"ot/ezra","display":"Ezra"},{"volume":"oldtestament","book":"ezra","chapStart":3,"chapEnd":7,"linkBase":"ot/ezra","display":"Ezra"},{"volume":"oldtestament","book":"nehemiah","chapStart":2,"chapEnd":2,"linkBase":"ot/neh","display":"Nehemiah"},{"volume":"oldtestament","book":"nehemiah","chapStart":4,"chapEnd":6,"linkBase":"ot/neh","display":"Nehemiah"},{"volume":"oldtestament","book":"nehemiah","chapStart":8,"chapEnd":8,"linkBase":"ot/neh","display":"Nehemiah"}]},
      {"start":"2026-08-03","end":"2026-08-09","title":"Thou Art Come ... for Such a Time as This","readings":[{"volume":"oldtestament","book":"esther","chapStart":1,"chapEnd":10,"linkBase":"ot/esth","display":"Esther"}]},
      {"start":"2026-08-10","end":"2026-08-16","title":"Yet Will I Trust in Him","readings":[{"volume":"oldtestament","book":"job","chapStart":1,"chapEnd":3,"linkBase":"ot/job","display":"Job"},{"volume":"oldtestament","book":"job","chapStart":12,"chapEnd":14,"linkBase":"ot/job","display":"Job"},{"volume":"oldtestament","book":"job","chapStart":19,"chapEnd":19,"linkBase":"ot/job","display":"Job"},{"volume":"oldtestament","book":"job","chapStart":21,"chapEnd":24,"linkBase":"ot/job","display":"Job"},{"volume":"oldtestament","book":"job","chapStart":38,"chapEnd":40,"linkBase":"ot/job","display":"Job"},{"volume":"oldtestament","book":"job","chapStart":42,"chapEnd":42,"linkBase":"ot/job","display":"Job"}]},
      {"start":"2026-08-17","end":"2026-08-23","title":"The Lord Is My Shepherd","readings":[{"volume":"oldtestament","book":"psalms","chapStart":1,"chapEnd":2,"linkBase":"ot/ps","display":"Psalms"},{"volume":"oldtestament","book":"psalms","chapStart":8,"chapEnd":8,"linkBase":"ot/ps","display":"Psalms"},{"volume":"oldtestament","book":"psalms","chapStart":19,"chapEnd":33,"linkBase":"ot/ps","display":"Psalms"},{"volume":"oldtestament","book":"psalms","chapStart":40,"chapEnd":40,"linkBase":"ot/ps","display":"Psalms"},{"volume":"oldtestament","book":"psalms","chapStart":46,"chapEnd":46,"linkBase":"ot/ps","display":"Psalms"}]},
      {"start":"2026-08-24","end":"2026-08-30","title":"I Will Declare What He Hath Done for My Soul","readings":[{"volume":"oldtestament","book":"psalms","chapStart":49,"chapEnd":51,"linkBase":"ot/ps","display":"Psalms"},{"volume":"oldtestament","book":"psalms","chapStart":61,"chapEnd":66,"linkBase":"ot/ps","display":"Psalms"},{"volume":"oldtestament","book":"psalms","chapStart":69,"chapEnd":72,"linkBase":"ot/ps","display":"Psalms"},{"volume":"oldtestament","book":"psalms","chapStart":77,"chapEnd":78,"linkBase":"ot/ps","display":"Psalms"},{"volume":"oldtestament","book":"psalms","chapStart":85,"chapEnd":86,"linkBase":"ot/ps","display":"Psalms"}]},
      {"start":"2026-08-31","end":"2026-09-06","title":"Let Every Thing That Hath Breath Praise the Lord","readings":[{"volume":"oldtestament","book":"psalms","chapStart":102,"chapEnd":103,"linkBase":"ot/ps","display":"Psalms"},{"volume":"oldtestament","book":"psalms","chapStart":110,"chapEnd":110,"linkBase":"ot/ps","display":"Psalms"},{"volume":"oldtestament","book":"psalms","chapStart":116,"chapEnd":119,"linkBase":"ot/ps","display":"Psalms"},{"volume":"oldtestament","book":"psalms","chapStart":127,"chapEnd":128,"linkBase":"ot/ps","display":"Psalms"},{"volume":"oldtestament","book":"psalms","chapStart":135,"chapEnd":139,"linkBase":"ot/ps","display":"Psalms"},{"volume":"oldtestament","book":"psalms","chapStart":146,"chapEnd":150,"linkBase":"ot/ps","display":"Psalms"}]},
      {"start":"2026-09-07","end":"2026-09-13","title":"He Shall Direct Thy Paths","readings":[{"volume":"oldtestament","book":"proverbs","chapStart":1,"chapEnd":4,"linkBase":"ot/prov","display":"Proverbs"},{"volume":"oldtestament","book":"proverbs","chapStart":15,"chapEnd":16,"linkBase":"ot/prov","display":"Proverbs"},{"volume":"oldtestament","book":"proverbs","chapStart":22,"chapEnd":22,"linkBase":"ot/prov","display":"Proverbs"},{"volume":"oldtestament","book":"proverbs","chapStart":31,"chapEnd":31,"linkBase":"ot/prov","display":"Proverbs"},{"volume":"oldtestament","book":"ecclesiastes","chapStart":1,"chapEnd":3,"linkBase":"ot/eccl","display":"Ecclesiastes"},{"volume":"oldtestament","book":"ecclesiastes","chapStart":11,"chapEnd":12,"linkBase":"ot/eccl","display":"Ecclesiastes"}]},
      {"start":"2026-09-14","end":"2026-09-20","title":"God Is My Salvation","readings":[{"volume":"oldtestament","book":"isaiah","chapStart":1,"chapEnd":12,"linkBase":"ot/isa","display":"Isaiah"}]},
      {"start":"2026-09-21","end":"2026-09-27","title":"A Marvellous Work and a Wonder","readings":[{"volume":"oldtestament","book":"isaiah","chapStart":13,"chapEnd":14,"linkBase":"ot/isa","display":"Isaiah"},{"volume":"oldtestament","book":"isaiah","chapStart":22,"chapEnd":22,"linkBase":"ot/isa","display":"Isaiah"},{"volume":"oldtestament","book":"isaiah","chapStart":24,"chapEnd":30,"linkBase":"ot/isa","display":"Isaiah"},{"volume":"oldtestament","book":"isaiah","chapStart":35,"chapEnd":35,"linkBase":"ot/isa","display":"Isaiah"}]},
      {"start":"2026-09-28","end":"2026-10-04","title":"Comfort Ye My People","readings":[{"volume":"oldtestament","book":"isaiah","chapStart":40,"chapEnd":49,"linkBase":"ot/isa","display":"Isaiah"}]},
      {"start":"2026-10-05","end":"2026-10-11","title":"He Hath Borne Our Griefs, and Carried Our Sorrows","readings":[{"volume":"oldtestament","book":"isaiah","chapStart":50,"chapEnd":57,"linkBase":"ot/isa","display":"Isaiah"}]},
      {"start":"2026-10-12","end":"2026-10-18","title":"The Redeemer Shall Come to Zion","readings":[{"volume":"oldtestament","book":"isaiah","chapStart":58,"chapEnd":66,"linkBase":"ot/isa","display":"Isaiah"}]},
      {"start":"2026-10-19","end":"2026-10-25","title":"Before I Formed Thee in the Belly I Knew Thee","readings":[{"volume":"oldtestament","book":"jeremiah","chapStart":1,"chapEnd":3,"linkBase":"ot/jer","display":"Jeremiah"},{"volume":"oldtestament","book":"jeremiah","chapStart":7,"chapEnd":7,"linkBase":"ot/jer","display":"Jeremiah"},{"volume":"oldtestament","book":"jeremiah","chapStart":16,"chapEnd":18,"linkBase":"ot/jer","display":"Jeremiah"},{"volume":"oldtestament","book":"jeremiah","chapStart":20,"chapEnd":20,"linkBase":"ot/jer","display":"Jeremiah"}]},
      {"start":"2026-10-26","end":"2026-11-01","title":"I Will Turn Their Mourning into Joy","readings":[{"volume":"oldtestament","book":"jeremiah","chapStart":31,"chapEnd":33,"linkBase":"ot/jer","display":"Jeremiah"},{"volume":"oldtestament","book":"jeremiah","chapStart":36,"chapEnd":39,"linkBase":"ot/jer","display":"Jeremiah"},{"volume":"oldtestament","book":"lamentations","chapStart":1,"chapEnd":1,"linkBase":"ot/lam","display":"Lamentations"},{"volume":"oldtestament","book":"lamentations","chapStart":3,"chapEnd":3,"linkBase":"ot/lam","display":"Lamentations"}]},
      {"start":"2026-11-02","end":"2026-11-08","title":"A New Spirit Will I Put within You","readings":[{"volume":"oldtestament","book":"ezekiel","chapStart":1,"chapEnd":3,"linkBase":"ot/ezek","display":"Ezekiel"},{"volume":"oldtestament","book":"ezekiel","chapStart":33,"chapEnd":34,"linkBase":"ot/ezek","display":"Ezekiel"},{"volume":"oldtestament","book":"ezekiel","chapStart":36,"chapEnd":37,"linkBase":"ot/ezek","display":"Ezekiel"},{"volume":"oldtestament","book":"ezekiel","chapStart":47,"chapEnd":47,"linkBase":"ot/ezek","display":"Ezekiel"}]},
      {"start":"2026-11-09","end":"2026-11-15","title":"There Is No Other God That Can Deliver","readings":[{"volume":"oldtestament","book":"daniel","chapStart":1,"chapEnd":7,"linkBase":"ot/dan","display":"Daniel"}]},
      {"start":"2026-11-16","end":"2026-11-22","title":"I Will Love Them Freely","readings":[{"volume":"oldtestament","book":"hosea","chapStart":1,"chapEnd":6,"linkBase":"ot/hosea","display":"Hosea"},{"volume":"oldtestament","book":"hosea","chapStart":10,"chapEnd":14,"linkBase":"ot/hosea","display":"Hosea"},{"volume":"oldtestament","book":"joel","chapStart":1,"chapEnd":3,"linkBase":"ot/joel","display":"Joel"}]},
      {"start":"2026-11-23","end":"2026-11-29","title":"Seek the Lord, and Ye Shall Live","readings":[{"volume":"oldtestament","book":"amos","chapStart":1,"chapEnd":9,"linkBase":"ot/amos","display":"Amos"},{"volume":"oldtestament","book":"obadiah","chapStart":1,"chapEnd":1,"linkBase":"ot/obad","display":"Obadiah"},{"volume":"oldtestament","book":"jonah","chapStart":1,"chapEnd":4,"linkBase":"ot/jonah","display":"Jonah"}]},
      {"start":"2026-11-30","end":"2026-12-06","title":"He Delighteth in Mercy","readings":[{"volume":"oldtestament","book":"micah","chapStart":1,"chapEnd":7,"linkBase":"ot/micah","display":"Micah"},{"volume":"oldtestament","book":"nahum","chapStart":1,"chapEnd":3,"linkBase":"ot/nahum","display":"Nahum"},{"volume":"oldtestament","book":"habakkuk","chapStart":1,"chapEnd":3,"linkBase":"ot/hab","display":"Habakkuk"},{"volume":"oldtestament","book":"zephaniah","chapStart":1,"chapEnd":3,"linkBase":"ot/zeph","display":"Zephaniah"}]},
      {"start":"2026-12-07","end":"2026-12-13","title":"Holiness unto the Lord","readings":[{"volume":"oldtestament","book":"haggai","chapStart":1,"chapEnd":2,"linkBase":"ot/hag","display":"Haggai"},{"volume":"oldtestament","book":"zechariah","chapStart":1,"chapEnd":4,"linkBase":"ot/zech","display":"Zechariah"},{"volume":"oldtestament","book":"zechariah","chapStart":7,"chapEnd":14,"linkBase":"ot/zech","display":"Zechariah"}]},
      {"start":"2026-12-14","end":"2026-12-20","title":"I Have Loved You, Saith the Lord","readings":[{"volume":"oldtestament","book":"malachi","chapStart":1,"chapEnd":4,"linkBase":"ot/mal","display":"Malachi"}]},
      {"start":"2026-12-21","end":"2026-12-27","title":"We Have Waited for Him, and He Will Save Us","readings":[]}
    ];
    const seasonStart = new Date(cfmWeeks[0].start + 'T00:00:00');
    const seasonEnd   = new Date(cfmWeeks[cfmWeeks.length - 1].end + 'T23:59:59');

    function parseISODate(s){ return new Date(s + 'T00:00:00'); }
    function inRange(d, s, e){ return d >= s && d <= e; }

    function currentCfmWeek(now=new Date()){
      for (const wk of cfmWeeks){
        const s = parseISODate(wk.start);
        const e = parseISODate(wk.end);
        if (inRange(now, s, e)) return wk;
      }
      return null;
    }

    function canonicalName(reading){
      if (reading.display) return reading.display;
      const b = (reading.book || '').toLowerCase();
      const map = {
        '1samuel':'1 Samuel','2samuel':'2 Samuel',
        '1kings':'1 Kings','2kings':'2 Kings',
        '1chronicles':'1 Chronicles','2chronicles':'2 Chronicles',
        'songofsongs':'Song of Songs','songofsolomon':'Song of Songs'
      };
      if (map[b]) return map[b];
      return b.charAt(0).toUpperCase() + b.slice(1);
    }

    function titleMatches(transcriptTitle, targetName){
      const d = transcriptTitle.toLowerCase();
      const t = (targetName || '').toLowerCase();
      if (!t) return false;
      if (t.includes('kings')) return d.includes('1-2 kings');
      if (t.includes('chronicles')) return d.includes('1-2 chronicles');
      if (t.includes('ezra') || t.includes('nehemiah')) return d.includes('ezra-nehemiah');
      if (t.includes('song of songs') || t.includes('song of solomon')) return d.includes('song of songs');
      return d.includes(t);
    }

    function pickPreferredKeyword(week){
      if (!week) return null;
      const reads = week.readings || [];
      if (reads.length === 0){
        if (/Introduction/i.test(week.title)) return 'Old Testament Summary';
        // generic fallback for empty-reading weeks
        return 'Old Testament Summary';
      }
      // Prefer Old Testament readings when present
      const items = reads.map(r => ({
        name: canonicalName(r),
        isOT: (r.volume || '').toLowerCase() === 'oldtestament'
      }));
      const pool = items.some(i => i.isOT) ? items.filter(i => i.isOT) : items;

      // Frequency-based pick (e.g., Leviticus-heavy week)
      const counts = new Map();
      for (const it of pool){
        counts.set(it.name, (counts.get(it.name)||0) + 1);
      }
      let best = null, bestCount = -1;
      for (const it of pool){
        const c = counts.get(it.name);
        if (c > bestCount){ best = it.name; bestCount = c; }
      }

      if (best) return best;

      // PGP special-casing -> map to Genesis videos as closest fit
      if (items.some(it => /moses|abraham/i.test(it.name))) return 'Genesis';

      return null;
    }

    function recommendedIndexForWeek(list, week){
      const keyword = pickPreferredKeyword(week);
      if (keyword){
        // If there are two parts, we will naturally match Part 1 by searching the first match.
        const idx = list.findIndex(item => titleMatches(item.display, keyword));
        if (idx >= 0) return idx;
      }
      // Reasonable fallbacks
      let idx = list.findIndex(item => /Genesis/i.test(item.display));
      if (idx >= 0) return idx;
      idx = list.findIndex(item => /Old Testament Summary/i.test(item.display));
      if (idx >= 0) return idx;
      return 0;
    }
    // ============================================================

    volumeOrder.forEach(v => volSel.add(new Option(v.replace(/-/g, ' ').replace(/\b\w/g, c => c.toUpperCase()), v)));
    volSel.value = 'old-testament';

    volSel.addEventListener('change', () => {
      populateStartVideos();
    });

    startVideo.addEventListener('change', () => {
      // remember last selected per volume (for non-2026 default behavior)
      try {
        localStorage.setItem('bp_lastStart_' + volSel.value, String(startVideo.value));
      } catch(e) {}
      updateEndOptions();
    });
    volSel.dispatchEvent(new Event('change'));

    function populateStartVideos() {
      const list = transcripts[volSel.value] || [];
      startVideo.innerHTML = '';
      endVideo.innerHTML = '';
      copyBtn.disabled = true;
      outTA.value = '';
      linkContainer.innerHTML = '';
      list.forEach((item, index) => {
        startVideo.add(new Option(item.display, index));
      });

      // ====== ADDED: Smart default selection per 2026 guide ======
      let defaultIdx = 0;
      const now = new Date();
      const isInSeason = now >= seasonStart && now <= seasonEnd;
      if (isInSeason && volSel.value === 'old-testament') {
        const wk = currentCfmWeek(now);
        defaultIdx = recommendedIndexForWeek(list, wk);
      } else {
        // Not in 2026 season -> default to last selected video for this volume (if available)
        try {
          const saved = localStorage.getItem('bp_lastStart_' + volSel.value);
          if (saved !== null && list[Number(saved)]) {
            defaultIdx = Number(saved);
          }
        } catch(e) {}
      }
      if (list.length) {
        startVideo.value = String(defaultIdx);
      }
      // ===========================================================

      updateEndOptions();
    }

    function updateEndOptions() {
      const list = transcripts[volSel.value] || [];
      const startIdx = parseInt(startVideo.value, 10);
      endVideo.innerHTML = '';
      endVideo.add(new Option('(optional)', ''));
      if (isNaN(startIdx)) {
        copyBtn.disabled = true;
        linkContainer.innerHTML = '';
        return;
      }
      for (let i = startIdx; i < list.length; i++) {
        endVideo.add(new Option(list[i].display, i));
      }
      endVideo.value = '';
    }

    fetchBtn.addEventListener('click', async () => {
      const list = transcripts[volSel.value] || [];
      const startIdx = parseInt(startVideo.value, 10);
      if (isNaN(startIdx) || !list[startIdx]) {
        outTA.value = 'Select a starting video first.';
        copyBtn.disabled = true;
        linkContainer.innerHTML = '';
        return;
      }
      let endIdx = parseInt(endVideo.value, 10);
      if (isNaN(endIdx) || endIdx < startIdx) {
        endIdx = startIdx;
      }

      copyBtn.disabled = true;
      outTA.value = 'Loading transcripts…';
      linkContainer.innerHTML = '';

      try {
        const range = list.slice(startIdx, endIdx + 1);
        const parts = [];
        let hasLinks = false;
        for (const item of range) {
          let text = textCache.get(item.path);
          if (!text) {
            const response = await fetch(encodeURI(item.path));
            if (!response.ok) {
              throw new Error(`Failed to load ${item.display} (${response.status})`);
            }
            text = await response.text();
            textCache.set(item.path, text);
          }
          parts.push(`${item.display}\n\n${text.trim()}`.trim());
          if (item.url) {
            const link = document.createElement('a');
            link.href = item.url;
            link.target = '_blank';
            link.rel = 'noopener';
            link.textContent = item.display;
            linkContainer.appendChild(link);
            hasLinks = true;
          }
        }
        if (!hasLinks) {
          linkContainer.innerHTML = '';
        }
        outTA.value = parts.join('\n\n\n');
        copyBtn.disabled = outTA.value.length === 0;
      } catch (err) {
        outTA.value = `Error loading transcripts: ${err.message}`;
        linkContainer.innerHTML = '';
      }
    });

    copyBtn.addEventListener('click', () => {
      if (!outTA.value) return;
      outTA.select();
      document.execCommand('copy');
      alert('Copied to clipboard!');
    });
  });
  </script>
</body>
</html>
