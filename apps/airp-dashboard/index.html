<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Self-Paced AIRP Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
:root {
  --bg: #0b1017;
  --bg2: #111726;
  --panel: rgba(15, 21, 33, 0.9);
  --accent: #5ee0ff;
  --accent-soft: rgba(94, 224, 255, 0.1);
  --accent2: #ff77c8;
  --text: #ebf5ff;
  --muted: #98a3b7;
  --danger: #ff567d;
  --radius-lg: 1.4rem;
  --radius-sm: 0.75rem;
  --gap: 1rem;
  --shadow: 0 16px 40px rgba(0,0,0,0.25);
  --card-border: 1px solid rgba(255,255,255,0.03);
}
*,
*::before,
*::after {
  box-sizing: border-box;
}
body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: radial-gradient(circle at 0% 0%, rgba(94,224,255,0.13), rgba(0,0,0,0)) fixed, #080b10;
  color: var(--text);
  min-height: 100vh;
}
.app-shell {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}
.header {
  position: sticky;
  top: 0;
  z-index: 10;
  backdrop-filter: blur(18px);
  background: rgba(8,11,16,0.8);
  border-bottom: 1px solid rgba(255,255,255,0.02);
  padding: 0.7rem 1rem 0.6rem 1rem;
  display: flex;
  align-items: center;
  gap: 1rem;
}
.title-block {
  display: flex;
  flex-direction: column;
}
.title-block h1 {
  font-size: 1.05rem;
  margin: 0;
  font-weight: 600;
}
.title-block small {
  color: var(--muted);
  font-size: 0.7rem;
}
.filters {
  display: flex;
  gap: 0.4rem;
  margin-left: auto;
}
.filter-btn {
  background: transparent;
  border: 1px solid transparent;
  border-radius: 999px;
  padding: 0.25rem 0.8rem 0.3rem 0.8rem;
  color: var(--muted);
  font-size: 0.7rem;
  cursor: pointer;
  transition: 0.12s ease-out;
}
.filter-btn.active {
  background: rgba(94,224,255,0.13);
  border-color: rgba(94,224,255,0.35);
  color: var(--text);
  box-shadow: 0 0 18px rgba(94,224,255,0.35);
}
.icon-btn {
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.03);
  width: 30px;
  height: 30px;
  border-radius: 999px;
  display: grid;
  place-items: center;
  cursor: pointer;
  color: var(--text);
  transition: 0.1s ease-out;
}
.icon-btn:hover {
  background: rgba(255,255,255,0.09);
}
main {
  padding: 1rem clamp(0.6rem, 2vw, 1.2rem);
  flex: 1;
  max-width: 1100px;
  margin: 0 auto;
  width: 100%;
}
.lecture-list {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 0.9rem;
  margin-bottom: 2.4rem;
}
.lecture-card {
  background: radial-gradient(circle at top, rgba(94,224,255,0.08), rgba(7,10,14,0.7));
  border: var(--card-border);
  border-radius: 1rem;
  padding: 0.85rem 0.85rem 0.75rem 0.85rem;
  box-shadow: 0 10px 25px rgba(0,0,0,0.15);
  display: flex;
  flex-direction: column;
  gap: 0.65rem;
  min-height: 200px;
  position: relative;
}
.lecture-card.done-all {
  border-color: rgba(119, 255, 196, 0.3);
  box-shadow: 0 0 20px rgba(119,255,196,0.1);
}
.lecture-head {
  display: flex;
  align-items: flex-start;
  gap: 0.5rem;
}
.badge-date {
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.03);
  border-radius: 0.5rem;
  padding: 0.25rem 0.55rem 0.35rem 0.55rem;
  font-size: 0.6rem;
  color: var(--muted);
  white-space: nowrap;
  margin-left: auto;
}
.lecture-title {
  font-size: 0.75rem;
  line-height: 1.25;
  font-weight: 600;
}
.link-line a {
  color: var(--accent);
  text-decoration: none;
  font-size: 0.63rem;
  word-break: break-all;
}
.link-line a:hover {
  text-decoration: underline;
}
.checklist {
  display: flex;
  gap: 0.4rem;
  flex-wrap: wrap;
}
.chk {
  background: rgba(0,0,0,0.25);
  border: 1px solid rgba(255,255,255,0.02);
  border-radius: 0.55rem;
  padding: 0.25rem 0.5rem;
  display: flex;
  gap: 0.25rem;
  align-items: center;
  cursor: pointer;
  font-size: 0.59rem;
}
.chk input {
  accent-color: var(--accent);
  width: 0.65rem;
  height: 0.65rem;
  margin: 0;
}
.chk-label {
  opacity: 0.8;
}
.cards-row {
  display: flex;
  gap: 0.35rem;
  align-items: center;
  font-size: 0.6rem;
  margin-top: -0.25rem;
}
.cards-pill {
  background: rgba(94,224,255,0.1);
  border: 1px solid rgba(94,224,255,0.25);
  border-radius: 999px;
  padding: 0.1rem 0.5rem 0.15rem 0.5rem;
  font-size: 0.6rem;
}
.cards-row button {
  background: rgba(255,255,255,0.02);
  border: 1px solid rgba(255,255,255,0.05);
  border-radius: 0.35rem;
  color: var(--text);
  width: 20px;
  height: 20px;
  line-height: 0;
  font-size: 0.65rem;
  cursor: pointer;
}
.cards-row button:hover {
  background: rgba(255,255,255,0.1);
}
.tag-status {
  position: absolute;
  top: 0.75rem;
  right: 0.75rem;
  font-size: 0.55rem;
  background: rgba(119,255,196,0.11);
  border: 1px solid rgba(119,255,196,0.35);
  color: #d2fff0;
  border-radius: 999px;
  padding: 0.12rem 0.5rem 0.18rem 0.5rem;
  display: none;
}
.lecture-card.done-all .tag-status {
  display: inline-flex;
}
.prefs-panel {
  position: fixed;
  top: 58px;
  right: 0.9rem;
  width: min(360px, 94vw);
  background: rgba(5,7,10,0.9);
  border: 1px solid rgba(255,255,255,0.04);
  border-radius: 1rem;
  padding: 0.75rem;
  box-shadow: 0 15px 30px rgba(0,0,0,0.25);
  z-index: 30;
  display: none;
}
.prefs-panel h2 {
  font-size: 0.75rem;
  margin: 0 0 0.3rem 0;
}
.prefs-panel small {
  font-size: 0.6rem;
  color: var(--muted);
  display: block;
  margin-bottom: 0.35rem;
}
.prefs-panel button,
.prefs-panel label {
  font-size: 0.63rem;
}
.prefs-panel button {
  background: rgba(94,224,255,0.1);
  color: var(--text);
  border: 1px solid rgba(94,224,255,0.3);
  border-radius: 0.45rem;
  padding: 0.25rem 0.6rem;
  cursor: pointer;
  margin-right: 0.25rem;
}
.prefs-panel button:hover {
  background: rgba(94,224,255,0.25);
}
footer {
  text-align: center;
  font-size: 0.55rem;
  color: rgba(255,255,255,0.3);
  margin-bottom: 1.4rem;
}
@media (max-width: 680px) {
  .header {
    flex-wrap: wrap;
    gap: 0.5rem;
  }
  .filters {
    order: 3;
    width: 100%;
  }
  .lecture-card {
    min-height: 220px;
  }
  .link-line a {
    word-break: break-word;
  }
}
</style>
</head>
<body>
<div class="app-shell">
  <header class="header">
    <div class="title-block">
      <h1>Self-Paced Lecture Dashboard</h1>
      <small>Watch → mark attendance → make ≥10 cards</small>
    </div>
    <div class="filters">
      <button class="filter-btn active" data-filter="all">All (44)</button>
      <button class="filter-btn" data-filter="needWatch">Need to watch</button>
      <button class="filter-btn" data-filter="needCards">Need cards</button>
    </div>
    <button class="icon-btn" id="prefsBtn" title="Preferences / Backup">⚙</button>
  </header>

  <main>
    <div id="lectureList" class="lecture-list"></div>
  </main>

  <footer>Saved automatically to this browser. Use ⚙ to export/import.</footer>

  <div class="prefs-panel" id="prefsPanel">
    <h2>Backup &amp; Sync</h2>
    <small>Download your progress as JSON and load it on another device.</small>
    <button id="downloadBtn">Download progress</button>
    <label for="uploadInput" style="cursor:pointer;color:var(--accent);text-decoration:underline;">Upload progress…</label>
    <input type="file" id="uploadInput" accept="application/json" style="display:none;" />
    <small id="prefsStatus"></small>
  </div>
</div>

<script>
const LECTURES = [
  {
    "id": 1,
    "date": "October 14",
    "title": "NR 123 Stroke: Central Nervous System Ischemia Self-paced Lecture (44:32)",
    "link": "https://acr.instructure.com/courses/411/assignments/37700"
  },
  {
    "id": 2,
    "date": "October 14",
    "title": "NR 112 Orbit Self-paced Lecture (46:54)",
    "link": "https://acr.instructure.com/courses/411/assignments/37683"
  },
  {
    "id": 3,
    "date": "October 15",
    "title": "NM 203 Introduction to Theranostics Self-Paced Lecture (33:26)",
    "link": "https://acr.instructure.com/courses/411/assignments/37719"
  },
  {
    "id": 4,
    "date": "October 15",
    "title": "NR 125 Degenerative and Inflammatory Diseases of the Spine Self-paced Lecture (39:33)",
    "link": "https://acr.instructure.com/courses/411/assignments/37708"
  },
  {
    "id": 5,
    "date": "October 15",
    "title": "NR 215 Imaging the Orbital Inflammatory and Infectious Diseases Self-paced Lecture (29:38)",
    "link": "https://acr.instructure.com/courses/411/assignments/37697"
  },
  {
    "id": 6,
    "date": "October 15",
    "title": "NR 212 MR and CT Evaluation of the Temporal Bone Self-paced Lecture (37:16)",
    "link": "https://acr.instructure.com/courses/411/assignments/37709"
  },
  {
    "id": 7,
    "date": "October 15",
    "title": "NR 206 Cystic and Solid Lesions of the Jaw Self-paced Lecture (33:11)",
    "link": "https://acr.instructure.com/courses/411/assignments/37701"
  },
  {
    "id": 8,
    "date": "October 16",
    "title": "PE 102 Chest Imaging in Children Self-paced Lecture (33:21)",
    "link": "https://acr.instructure.com/courses/411/assignments/37721"
  },
  {
    "id": 9,
    "date": "October 16",
    "title": "PE 111 Pediatric Genitourinary Imaging Self-paced Lecture (38:54)",
    "link": "https://acr.instructure.com/courses/411/assignments/37723"
  },
  {
    "id": 10,
    "date": "October 16",
    "title": "PE 101 Pediatric Neuroradiology Self-paced Lecture (32:39)",
    "link": "https://acr.instructure.com/courses/411/assignments/37720"
  },
  {
    "id": 11,
    "date": "October 16",
    "title": "NR 114 Paranasal Sinuses and the Face Self-paced Lecture (36:34)",
    "link": "https://acr.instructure.com/courses/411/assignments/37684"
  },
  {
    "id": 12,
    "date": "October 16",
    "title": "NR 126 Congenital Anomalies of the Brain Self-paced Lecture (46:58)",
    "link": "https://acr.instructure.com/courses/411/assignments/37710"
  },
  {
    "id": 13,
    "date": "October 20",
    "title": "MS 105 Soft Tissue Masses Self-paced Lecture (48:48)",
    "link": "https://acr.instructure.com/courses/411/assignments/37718"
  },
  {
    "id": 14,
    "date": "October 20",
    "title": "MS 104 Osteochondritis Dissecans, Osteochondral Lesions and Patellofemoral Pathology Self-paced Lecture (29:52)",
    "link": "https://acr.instructure.com/courses/411/assignments/37717"
  },
  {
    "id": 15,
    "date": "October 20",
    "title": "MS 103 Internal Derangements of the Knee Self-paced Lecture (27:25)",
    "link": "https://acr.instructure.com/courses/411/assignments/37716"
  },
  {
    "id": 16,
    "date": "October 20",
    "title": "MS 222 Scrotal Pathology Self-paced Lecture (33:02)",
    "link": "https://acr.instructure.com/courses/411/assignments/37688"
  },
  {
    "id": 17,
    "date": "October 20",
    "title": "MS 220 The Arthritic Knee Self-paced Lecture (26:51)",
    "link": "https://acr.instructure.com/courses/411/assignments/37686"
  },
  {
    "id": 18,
    "date": "October 21",
    "title": "MS 101 Anatomy and Pathology of the Shoulder Self-paced Lecture (35:09)",
    "link": "https://acr.instructure.com/courses/411/assignments/37714"
  },
  {
    "id": 19,
    "date": "October 21",
    "title": "MS 221 Sports Injuries in the Young Self-paced Lecture (31:43)",
    "link": "https://acr.instructure.com/courses/411/assignments/37687"
  },
  {
    "id": 20,
    "date": "October 21",
    "title": "MS 219 Knee and Shoulder Injuries in Athletes Self-paced Lecture (50:45)",
    "link": "https://acr.instructure.com/courses/411/assignments/37685"
  },
  {
    "id": 21,
    "date": "October 21",
    "title": "MS 102 Anatomy and Pathology of the Elbow Self-paced Lecture (32:03)",
    "link": "https://acr.instructure.com/courses/411/assignments/37715"
  },
  {
    "id": 22,
    "date": "October 21",
    "title": "MS 118 Introduction to MR Imaging of the Musculoskeletal System Self-paced Lecture (33:08)",
    "link": "https://acr.instructure.com/courses/411/assignments/37713"
  },
  {
    "id": 23,
    "date": "October 22",
    "title": "NM 202 PET/CT Imaging: Oncologic Applications Self-paced Lecture (53:25)",
    "link": "https://acr.instructure.com/courses/411/assignments/37707"
  },
  {
    "id": 24,
    "date": "October 22",
    "title": "MS 217 Acute Shoulder Instability Self-paced Lecture (28:51)",
    "link": "https://acr.instructure.com/courses/411/assignments/37690"
  },
  {
    "id": 25,
    "date": "October 22",
    "title": "MS 214 Radiologic Evaluation of Musculoskeletal Infection Self-paced Lecture (35:42)",
    "link": "https://acr.instructure.com/courses/411/assignments/37689"
  },
  {
    "id": 26,
    "date": "October 22",
    "title": "MS 205 Rheumatologic Joint Disease Self-paced Lecture (42:53)",
    "link": "https://acr.instructure.com/courses/411/assignments/37712"
  },
  {
    "id": 27,
    "date": "October 23",
    "title": "NM 201 SPECT/CT Imaging: Oncologic, Non-oncologic and Musculoskeletal Applications Self-paced Lecture (46:11)",
    "link": "https://acr.instructure.com/courses/411/assignments/37706"
  },
  {
    "id": 28,
    "date": "October 23",
    "title": "MS 108 Imaging of the Spine Self-paced Lecture (44:17)",
    "link": "https://acr.instructure.com/courses/411/assignments/37711"
  },
  {
    "id": 29,
    "date": "October 23",
    "title": "MS 109 Imaging of Trauma to the Skeleton Self-paced Lecture (35:47)",
    "link": "https://acr.instructure.com/courses/411/assignments/37705"
  },
  {
    "id": 30,
    "date": "October 23",
    "title": "MS 107 Arthritis and Arthropathies Self-paced Lecture (31:58)",
    "link": "https://acr.instructure.com/courses/411/assignments/37704"
  },
  {
    "id": 31,
    "date": "November 3",
    "title": "BI 104 Imaging the Augmented Breast Self-paced Lecture (36:38)",
    "link": "https://acr.instructure.com/courses/411/assignments/38033"
  },
  {
    "id": 32,
    "date": "November 3",
    "title": "BI 106 Clinical Cases in Breast MRI Self-paced Lecture (29:25)",
    "link": "https://acr.instructure.com/courses/411/assignments/38035"
  },
  {
    "id": 33,
    "date": "November 3",
    "title": "BI 107 Practical Breast MRI Reporting Self-paced Lecture (30:34)",
    "link": "https://acr.instructure.com/courses/411/assignments/38036"
  },
  {
    "id": 34,
    "date": "November 3",
    "title": "BI 205 Advanced Problem Solving: Asymmetries, Distortions and Masses Self-paced Lecture (32:15)",
    "link": "https://acr.instructure.com/courses/411/assignments/38027"
  },
  {
    "id": 35,
    "date": "November 4",
    "title": "BI 110 MRI of the Breast: DCE, DW, ASL and Other Advanced Techniques Self-paced Lecture (29:21)",
    "link": "https://acr.instructure.com/courses/411/assignments/38038"
  },
  {
    "id": 36,
    "date": "November 4",
    "title": "BI 101 Detecting Breast Cancer: Key Concepts for the Screening Breast Imager Self-paced Lecture (32:03)",
    "link": "https://acr.instructure.com/courses/411/assignments/38032"
  },
  {
    "id": 37,
    "date": "November 4",
    "title": "BI 102 Diagnostic Evaluation of the Symptomatic Patient Self-paced Lecture (34:57)",
    "link": "https://acr.instructure.com/courses/411/assignments/38039"
  },
  {
    "id": 38,
    "date": "November 4",
    "title": "BI 103 Diagnostic Imaging Following a Positive Screening Exam Self-paced Lecture (37:34)",
    "link": "https://acr.instructure.com/courses/411/assignments/38034"
  },
  {
    "id": 39,
    "date": "November 5",
    "title": "BI 206 Advanced Problem Solving: Calcifications Self-paced Lecture (35:46)",
    "link": "https://acr.instructure.com/courses/411/assignments/38028"
  },
  {
    "id": 40,
    "date": "November 6",
    "title": "BI 105 Interventional Breast Procedures: Pre-procedural Imaging and Planning Self-paced Lecture (33:01)",
    "link": "https://acr.instructure.com/courses/411/assignments/38037"
  },
  {
    "id": 41,
    "date": "November 6",
    "title": "BI 108 Mammography and Digital Breast Tomosynthesis: High Risk and Screening Strategies Self-paced Lecture (35:11)",
    "link": "https://acr.instructure.com/courses/411/assignments/38040"
  },
  {
    "id": 42,
    "date": "November 7",
    "title": "BI 211 DCIS: MRI Self-paced Lecture (23:15)",
    "link": "https://acr.instructure.com/courses/411/assignments/38041"
  },
  {
    "id": 43,
    "date": "November 7",
    "title": "BI 203 Breast Diseases in Young Women Self-paced Lecture (27:10)",
    "link": "https://acr.instructure.com/courses/411/assignments/38030"
  },
  {
    "id": 44,
    "date": "November 7",
    "title": "BI 204 Breast Disease in Males Self-paced Lecture (21:30)",
    "link": "https://acr.instructure.com/courses/411/assignments/38031"
  }
];

const STORAGE_KEY = "airpSelfPacedProgress_v1";

function loadProgress() {
  try {
    const raw = localStorage.getItem(STORAGE_KEY);
    if (!raw) {
      return {};
    }
    return JSON.parse(raw);
  } catch (e) {
    console.warn("Failed to parse progress", e);
    return {};
  }
}

function saveProgress(progress) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(progress));
}

let progress = loadProgress();
let currentFilter = "all";

function ensureProgressSkeleton() {
  LECTURES.forEach(l => {
    if (!progress[l.id]) {
      progress[l.id] = {
        watched: false,
        attendance: false,
        cards: 0
      };
    }
  });
}
ensureProgressSkeleton();

function render() {
  const container = document.getElementById("lectureList");
  container.innerHTML = "";
  LECTURES.forEach(lecture => {
    const p = progress[lecture.id] || { watched: false, attendance: false, cards: 0 };
    // filter
    if (currentFilter === "needWatch" && p.watched) {
      return;
    }
    if (currentFilter === "needCards" && p.cards >= 10) {
      return;
    }
    const allDone = p.watched && p.attendance && p.cards >= 10;

    const card = document.createElement("div");
    card.className = "lecture-card" + (allDone ? " done-all" : "");
    card.dataset.id = lecture.id;

    const head = document.createElement("div");
    head.className = "lecture-head";

    const title = document.createElement("div");
    title.className = "lecture-title";
    title.textContent = lecture.title;

    const date = document.createElement("div");
    date.className = "badge-date";
    date.textContent = lecture.date;

    head.appendChild(title);
    head.appendChild(date);

    const tag = document.createElement("span");
    tag.className = "tag-status";
    tag.textContent = "Done ✓";
    card.appendChild(tag);

    card.appendChild(head);

    const link = document.createElement("div");
    link.className = "link-line";
    const a = document.createElement("a");
    a.href = lecture.link;
    a.textContent = lecture.link;
    a.target = "_blank";
    a.rel = "noopener noreferrer";
    link.appendChild(a);
    card.appendChild(link);

    const checklist = document.createElement("div");
    checklist.className = "checklist";

    const makeCheck = (label, key) => {
      const c = document.createElement("label");
      c.className = "chk";
      const input = document.createElement("input");
      input.type = "checkbox";
      input.checked = !!p[key];
      input.addEventListener("change", () => {
        progress[lecture.id][key] = input.checked;
        saveProgress(progress);
        render();
      });
      const span = document.createElement("span");
      span.className = "chk-label";
      span.textContent = label;
      c.appendChild(input);
      c.appendChild(span);
      return c;
    };

    checklist.appendChild(makeCheck("Watched", "watched"));
    checklist.appendChild(makeCheck("Attendance", "attendance"));

    card.appendChild(checklist);

    const cardsRow = document.createElement("div");
    cardsRow.className = "cards-row";
    const cardsPill = document.createElement("span");
    cardsPill.className = "cards-pill";
    cardsPill.textContent = "Cards: " + (p.cards || 0) + "/10";
    cardsRow.appendChild(cardsPill);

    const minusBtn = document.createElement("button");
    minusBtn.textContent = "−";
    minusBtn.addEventListener("click", () => {
      const current = progress[lecture.id].cards || 0;
      const next = Math.max(0, current - 1);
      progress[lecture.id].cards = next;
      saveProgress(progress);
      render();
    });

    const plusBtn = document.createElement("button");
    plusBtn.textContent = "+";
    plusBtn.addEventListener("click", () => {
      const current = progress[lecture.id].cards || 0;
      const next = Math.min(30, current + 1);
      progress[lecture.id].cards = next;
      saveProgress(progress);
      render();
    });

    const quick10 = document.createElement("button");
    quick10.textContent = "10";
    quick10.title = "Mark 10 cards made";
    quick10.addEventListener("click", () => {
      progress[lecture.id].cards = 10;
      saveProgress(progress);
      render();
    });

    cardsRow.appendChild(minusBtn);
    cardsRow.appendChild(plusBtn);
    cardsRow.appendChild(quick10);

    card.appendChild(cardsRow);

    container.appendChild(card);
  });
}

document.querySelectorAll(".filter-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".filter-btn").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    currentFilter = btn.dataset.filter;
    render();
  });
});

const prefsBtn = document.getElementById("prefsBtn");
const prefsPanel = document.getElementById("prefsPanel");
prefsBtn.addEventListener("click", () => {
  prefsPanel.style.display = prefsPanel.style.display === "block" ? "none" : "block";
});

document.getElementById("downloadBtn").addEventListener("click", () => {
  const blob = new Blob([JSON.stringify(progress, null, 2)], { type: "application/json" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "airp-self-paced-progress.json";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  const status = document.getElementById("prefsStatus");
  status.textContent = "Downloaded.";
  setTimeout(() => status.textContent = "", 4000);
});

document.getElementById("uploadInput").addEventListener("change", (e) => {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = () => {
    try {
      const data = JSON.parse(reader.result);
      // merge to keep any new lectures
      LECTURES.forEach(l => {
        if (!data[l.id]) {
          data[l.id] = {
            watched: false,
            attendance: false,
            cards: 0
          };
        }
      });
      progress = data;
      saveProgress(progress);
      render();
      document.getElementById("prefsStatus").textContent = "Imported successfully.";
    } catch (err) {
      document.getElementById("prefsStatus").textContent = "Import failed: invalid JSON.";
    }
    setTimeout(() => document.getElementById("prefsStatus").textContent = "", 5000);
  };
  reader.readAsText(file);
});

render();
</script>
</body>
</html>
