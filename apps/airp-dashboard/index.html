<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AIRP Self-Paced Dashboard</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root {
      --bg: #020617;
      --panel: rgba(15,23,42,0.55);
      --panel-solid: rgba(2,6,23,0.6);
      --text: #e2e8f0;
      --muted: #94a3b8;
      --accent: #38bdf8;
      --accent-soft: rgba(56,189,248,.21);
      --green: #22c55e;
      --green-soft: rgba(34,197,94,.25);
      --red: #f97316;
      --radius: 1rem;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: radial-gradient(circle at top, #1f2937 0%, #020617 55%, #020617 100%);
      color: var(--text);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      padding: 1rem;
      line-height: 1.4;
    }
    header {
      display: flex;
      flex-wrap: wrap;
      gap: .6rem;
      align-items: center;
      margin-bottom: .7rem;
    }
    h1 {
      font-size: 1.25rem;
      margin: 0;
    }
    .badge {
      background: rgba(56,189,248,.12);
      border: 1px solid rgba(56,189,248,.4);
      border-radius: 999px;
      padding: .25rem .7rem;
      font-size: .7rem;
    }
    .filters {
      display: flex;
      gap: .35rem;
      flex-wrap: wrap;
      margin-left: auto;
    }
    .filter-btn {
      background: rgba(15,23,42,.3);
      border: 1px solid rgba(148,163,184,0.25);
      border-radius: 999px;
      padding: .3rem .6rem;
      font-size: .7rem;
      color: var(--text);
      cursor: pointer;
    }
    .filter-btn.active {
      background: rgba(56,189,248,.15);
      border-color: rgba(56,189,248,.6);
      box-shadow: 0 0 12px rgba(56,189,248,.45);
    }
    #controls {
      display: flex;
      gap: .4rem;
      flex-wrap: wrap;
      margin-bottom: .7rem;
    }
    .secondary-btn {
      background: rgba(15,23,42,.15);
      border: 1px solid rgba(148,163,184,.18);
      color: var(--muted);
      border-radius: 999px;
      padding: .28rem .6rem;
      font-size: .65rem;
      cursor: pointer;
      display: inline-flex;
      gap: .25rem;
      align-items: center;
    }
    #list {
      display: flex;
      flex-direction: column;
      gap: .6rem;
    }
    .card {
      background: linear-gradient(135deg, rgba(15,23,42,.35) 0%, rgba(15,23,42,.08) 100%);
      border: 1px solid rgba(148,163,184,.12);
      border-radius: 1rem;
      padding: .55rem .7rem;
      backdrop-filter: blur(7px);
      transition: .15s ease;
      cursor: pointer;
      box-shadow: 0 12px 25px rgba(0,0,0,.22);
    }
    .card.expanded {
      background: radial-gradient(circle at top, rgba(15,23,42,0.95) 0%, rgba(2,6,23,0.75) 60%);
      border: 1px solid rgba(148,163,184,.4);
    }
    .card-glow-blue {
      box-shadow: 0 0 0 1px rgba(59,130,246,.3), 0 14px 35px rgba(59,130,246,.55);
    }
    .card-glow-green {
      box-shadow: 0 0 0 1px rgba(34,197,94,.35), 0 16px 42px rgba(34,197,94,.6);
      border-color: rgba(34,197,94,.85);
    }
    .topline {
      display: flex;
      gap: .6rem;
      align-items: center;
    }
    .emoji-strip {
      font-size: 1.6rem;
      line-height: 1;
      flex: 0 0 auto;
    }
    .title-block {
      display: flex;
      flex-direction: column;
      gap: .1rem;
      flex: 1;
      min-width: 0;
    }
    .title {
      font-size: 1rem;
      font-weight: 600;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .date {
      font-size: .68rem;
      color: var(--muted);
    }
    .status-pill {
      font-size: .6rem;
      background: rgba(15,23,42,.28);
      border: 1px solid rgba(148,163,184,.18);
      border-radius: .6rem;
      padding: .25rem .5rem;
      flex: 0 0 auto;
    }
    .expand-indicator {
      font-size: .95rem;
      color: var(--muted);
      flex: 0 0 auto;
    }
    .details {
      display: none;
      margin-top: .55rem;
      gap: .5rem;
      flex-wrap: wrap;
      align-items: center;
    }
    .card.expanded .details { display: flex; }
    .link-btn {
      background: rgba(56,189,248,.08);
      border: 1px solid rgba(56,189,248,.35);
      color: #e2e8f0;
      border-radius: .5rem;
      padding: .25rem .5rem;
      font-size: .65rem;
      text-decoration: none;
    }
    .check-group {
      display: flex;
      gap: .4rem;
      flex-wrap: wrap;
    }
    .check-pill {
      display: inline-flex;
      align-items: center;
      gap: .3rem;
      background: rgba(15,23,42,.45);
      border: 1px solid rgba(148,163,184,.35);
      border-radius: .6rem;
      padding: .35rem .55rem .35rem .35rem;
      cursor: pointer;
      font-size: .72rem;
      transition: .1s ease;
    }
    .check-pill input[type="checkbox"] {
      appearance: none;
      width: 18px;
      height: 18px;
      border: 2px solid rgba(148,163,184,.8);
      border-radius: .4rem;
      background: rgba(15,23,42,.2);
      position: relative;
    }
    .check-pill input[type="checkbox"]:checked {
      background: rgba(56,189,248,1);
      border-color: rgba(56,189,248,1);
      box-shadow: 0 0 8px rgba(56,189,248,.45);
    }
    .check-pill input[type="checkbox"]:checked::after {
      content: "âœ“";
      position: absolute;
      top: -1px;
      left: 3px;
      font-size: .6rem;
      color: #020617;
    }
    .check-pill.checked {
      background: rgba(56,189,248,.15);
      border-color: rgba(56,189,248,.8);
    }
    .anki-group {
      display: flex;
      align-items: center;
      gap: .35rem;
      background: rgba(15,23,42,.25);
      border: 1px solid rgba(148,163,184,.3);
      border-radius: .5rem;
      padding: .2rem .35rem;
      font-size: .68rem;
    }
    .anki-count {
      min-width: 2.1rem;
      text-align: center;
      font-weight: 600;
      background: rgba(15,23,42,.35);
      border-radius: .35rem;
      padding: .1rem .25rem;
    }
    .anki-btn {
      background: rgba(15,23,42,.35);
      border: 1px solid rgba(148,163,184,.35);
      border-radius: .4rem;
      width: 24px;
      height: 24px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: #e2e8f0;
      font-size: .7rem;
    }
    .anki-btn.large {
      width: auto;
      padding: 0 .4rem;
      font-size: .62rem;
    }
    @media (max-width: 750px) {
      .title { white-space: normal; }
      header { flex-direction: column; align-items: flex-start; }
      .filters { margin-left: 0; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Self-Paced ACR / AIRP Lectures</h1>
    <span class="badge" id="progress-badge">0 / 44 complete</span>
    <div class="filters">
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn" data-filter="need-watch">Need to watch</button>
      <button class="filter-btn" data-filter="need-cards">Need cards</button>
    </div>
  </header>
  <div id="controls">
    <button class="secondary-btn" id="expand-all">Expand all</button>
    <button class="secondary-btn" id="collapse-all">Collapse all</button>
    <button class="secondary-btn" id="export-btn">Export progress</button>
    <label class="secondary-btn" for="import-file">Import progress
      <input id="import-file" type="file" accept="application/json" style="display:none" />
    </label>
  </div>
  <div id="list"></div>

  <script>
    // exact order from your ICS (44)
    const LECTURES = [
      {"id": "37700", "title": "NR 123 Stroke: Central Nervous Syste...Self-paced Lecture (44:32)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-07"},
      {"id": "37683", "title": "NR 161 - Inflammatory Brain Diseas...Self-paced Lecture (46:54)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-08"},
      {"id": "37719", "title": "NR 132 Tumors, Tumefactive, and Mu...Self-paced Lecture (49:28)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-08"},
      {"id": "37701", "title": "NM 101 PET in Oncologic Imaging Se...Self-paced Lecture (44:26)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-09"},
      {"id": "37702", "title": "NM 102 PET/CT Self-paced Lecture (34:00) ðŸŽ¦ [Oct_2025]", "date": "2025-10-09"},
      {"id": "37711", "title": "NM 113 PET/CT for GI Malignancies S...Self-paced Lecture (35:24)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-09"},
      {"id": "37712", "title": "NM 114 PET/CT for Lung Cancer Self-paced Lecture (28:37) ðŸŽ¦ [Oct_2025]", "date": "2025-10-09"},
      {"id": "37733", "title": "CV 101 Coronary Artery Diseases: Ch...Self-paced Lecture (43:55)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-10"},
      {"id": "37724", "title": "CV 103 Dissection, Aneurysm, and Tr...Self-paced Lecture (43:40)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-10"},
      {"id": "37727", "title": "TH 102 Radiology of the Thymus Self-paced Lecture (45:27) ðŸŽ¦ [Oct_2025]", "date": "2025-10-10"},
      {"id": "37723", "title": "TH 101 Airways Diseases Self-paced Lecture (43:55) ðŸŽ¦ [Oct_2025]", "date": "2025-10-10"},
      {"id": "37760", "title": "TH 132 Diffuse Lung Disease Self-paced Lecture (46:13) ðŸŽ¦ [Oct_2025]", "date": "2025-10-14"},
      {"id": "37757", "title": "TH 133 Occupational Lung Disease Se...Self-paced Lecture (34:50)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-14"},
      {"id": "37809", "title": "BI 111 - Breast Imaging: Malignant ...Self-paced Lecture (38:39)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-15"},
      {"id": "37824", "title": "BI 117 - Breast MRI: Benign and Mal...Self-paced Lecture (45:08)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-15"},
      {"id": "37846", "title": "PD 101 Pediatric Chest and Abdomen ...Self-paced Lecture (47:52)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-22"},
      {"id": "37843", "title": "PD-CR 103 - Pediatric Hip, Case Re...Self-paced Lecture (22:16)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-23"},
      {"id": "37810", "title": "PD 102 - Pediatric Airway and Neck...Self-paced Lecture (35:05) ðŸŽ¦  [Oct_2025]", "date": "2025-10-23"},
      {"id": "37811", "title": "PD 104 Radiology of Child Abuse Self-paced Lecture (48:36)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-23"},
      {"id": "37839", "title": "PD 121 Congenital Heart Disease Pa...lf-paced Lecture (1:02:19) ðŸŽ¦  [Oct_2025]", "date": "2025-10-24"},
      {"id": "38176", "title": "GU 222 - Prostate MRI  Self-paced Lecture (37:15) ðŸŽ¦ [Oct_2025]", "date": "2025-10-27"},
      {"id": "37889", "title": "GI 209 Pancreatitis Self-paced Lecture ðŸŽ¦  [Oct_2025]", "date": "2025-10-29"},
      {"id": "37894", "title": "GI 212 The Spleen Self-paced Lecture (48:01) ðŸŽ¦  [Oct_2025]", "date": "2025-10-29"},
      {"id": "37882", "title": "GI 205 - Imaging of Biliary Diseas...Self-paced Lecture (44:45)  ðŸŽ¦ [Oct_2025]", "date": "2025-10-29"},
      {"id": "37875", "title": "GI 104 Imaging of Liver Metastases... Self-paced Lecture (38:59) ðŸŽ¦ [Oct_2025]", "date": "2025-10-31"},
      {"id": "37964", "title": "MS 115 Imaging of Ewing Sarcoma an... Self-paced Lecture (42:43)ðŸŽ¦  [Oct_2025]", "date": "2025-11-03"},
      {"id": "37929", "title": "MS 101a Fundamental Concepts of Mu...lf-paced Lecture (1:15:16) ðŸŽ¦  [Oct_2025]", "date": "2025-11-03"},
      {"id": "37930", "title": "MS 101b Fundamental Concepts of Mu...elf-paced Lecture (1:09:54) ðŸŽ¦ [Oct_2025]", "date": "2025-11-03"},
      {"id": "37949", "title": "MS 108 Skeletal Metastases, Myelom... Self-paced Lecture (42:27)ðŸŽ¦  [Oct_2025]", "date": "2025-11-03"},
      {"id": "37931", "title": "MS 102 Osteonecrosis and Femoracet...elf-paced Lecture (1:00:58)ðŸŽ¦  [Oct_2025]", "date": "2025-11-04"},
      {"id": "37936", "title": "MS 109 Soft Tissue Tumors Self-paced Lecture (1:03:05) ðŸŽ¦ [Oct_2025]", "date": "2025-11-04"},
      {"id": "37937", "title": "MS 110 Soft Tissue Tumors of the R...lf-paced Lecture (1:00:57) ðŸŽ¦ [Oct_2025]", "date": "2025-11-04"},
      {"id": "37947", "title": "MS 114 Imaging of Benign Bone Tumo...Self-paced Lecture (51:58) ðŸŽ¦ [Oct_2025]", "date": "2025-11-05"},
      {"id": "37965", "title": "MS 116 MSK Manifestations of Chronic Renal Insuffi...eomalacia, and Rickets Self-paced Lecture (39:44) ðŸŽ¦ [Oct_2025]", "date": "2025-11-05"},
      {"id": "37948", "title": "MS 113 Crystal Deposition Disease ...Self-paced Lecture (45:44) ðŸŽ¦ [Oct_2025]", "date": "2025-11-06"},
      {"id": "37950", "title": "MS 117 Radiology of Sports Injuries Self-paced Lecture (1:10:40) ðŸŽ¦ [Oct_2025]", "date": "2025-11-06"},
      {"id": "38002", "title": "OB-GYN 101: Imaging of the Female Pelvis Self-paced Lecture (52:52) ðŸŽ¦ [Oct_2025]", "date": "2025-11-12"},
      {"id": "38003", "title": "OB-GYN 105: Imaging of the Pregnan...Self-paced Lecture (58:08) ðŸŽ¦ [Oct_2025]", "date": "2025-11-12"},
      {"id": "38004", "title": "OB-GYN 106: Imaging of Acute Pelvi...Self-paced Lecture (46:08) ðŸŽ¦ [Oct_2025]", "date": "2025-11-12"},
      {"id": "38005", "title": "OB-GYN 107: First Trimester Pregna...Self-paced Lecture (46:11) ðŸŽ¦ [Oct_2025]", "date": "2025-11-12"},
      {"id": "38039", "title": "NR 107 Brain Trauma Self-paced Lecture (44:59) ðŸŽ¦ [Oct_2025]", "date": "2025-12-08"},
      {"id": "38040", "title": "NR 118 Head and Neck Self-paced Lecture (43:10) ðŸŽ¦ [Oct_2025]", "date": "2025-12-08"},
      {"id": "38041", "title": "MS 134 Musculoskeletal Infections Self-paced Lecture (44:19) ðŸŽ¦ [Oct_2025]", "date": "2025-12-09"}
    ];

    const STORAGE_KEY = "acrSelfPacedProgressV3";

    // helpers
    function emojiFor(title) {
      if (title.startsWith("NR")) return "ðŸ§ ";
      if (title.startsWith("NM")) return "âš›ï¸";
      if (title.startsWith("CV")) return "â¤ï¸";
      if (title.startsWith("TH")) return "ðŸŒ¬ï¸";
      if (title.startsWith("BI")) return "ðŸ©·";
      if (title.startsWith("PD")) return "ðŸ§’";
      if (title.startsWith("GI") || title.startsWith("GU") || title.startsWith("OB")) return "ðŸ«";
      if (title.startsWith("MS")) return "ðŸ¦´";
      return "ðŸ“š";
    }
    function formatDate(iso) {
      const d = new Date(iso + "T12:00:00");
      return d.toLocaleDateString(undefined, { month: "short", day: "numeric" });
    }

    // load state
    let state = (function() {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) {
        const init = {};
        LECTURES.forEach(l => {
          init[l.id] = { watched: false, attendance: false, anki: 0, expanded: false };
        });
        return init;
      }
      try {
        const parsed = JSON.parse(raw);
        // make sure all entries exist
        LECTURES.forEach(l => {
          if (!parsed[l.id]) {
            parsed[l.id] = { watched: false, attendance: false, anki: 0, expanded: false };
          }
        });
        return parsed;
      } catch (e) {
        console.warn("bad stored progress", e);
        const init = {};
        LECTURES.forEach(l => {
          init[l.id] = { watched: false, attendance: false, anki: 0, expanded: false };
        });
        return init;
      }
    })();

    function saveState() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
      updateProgressBadge();
    }

    const listEl = document.getElementById("list");

    function createCheckPill(label, checked, onChange) {
      const pill = document.createElement("label");
      pill.className = "check-pill" + (checked ? " checked" : "");
      const input = document.createElement("input");
      input.type = "checkbox";
      input.checked = checked;
      const span = document.createElement("span");
      span.textContent = label;
      pill.append(input, span);
      pill.addEventListener("click", (ev) => {
        ev.stopPropagation();
        const val = !input.checked;
        input.checked = val;
        pill.classList.toggle("checked", val);
        onChange(val);
      });
      return pill;
    }

    function applyGlow(card, st) {
      card.classList.remove("card-glow-blue", "card-glow-green");
      const pill = card.querySelector(".status-pill");
      if (st.anki >= 10) {
        card.classList.add("card-glow-green");
        pill.textContent = "10+ cards made";
      } else if (st.watched && st.attendance) {
        card.classList.add("card-glow-blue");
        pill.textContent = "watched + attendance";
      } else {
        pill.textContent = "not done";
      }
      updateProgressBadge();
      filterList(currentFilter);
    }

    function buildCard(lec) {
      const st = state[lec.id];
      const card = document.createElement("div");
      card.className = "card";
      card.dataset.id = lec.id;
      if (st.expanded) card.classList.add("expanded");

      const top = document.createElement("div");
      top.className = "topline";

      const emoji = document.createElement("div");
      emoji.className = "emoji-strip";
      emoji.textContent = emojiFor(lec.title);

      const tblock = document.createElement("div");
      tblock.className = "title-block";
      const title = document.createElement("div");
      title.className = "title";
      title.textContent = lec.title;
      const date = document.createElement("div");
      date.className = "date";
      date.textContent = formatDate(lec.date);
      tblock.append(title, date);

      const status = document.createElement("div");
      status.className = "status-pill";
      status.textContent = (st.anki >= 10) ? "10+ cards made" : (st.watched && st.attendance ? "watched + attendance" : "not done");

      const exp = document.createElement("div");
      exp.className = "expand-indicator";
      exp.textContent = st.expanded ? "â–²" : "â–¼";

      top.append(emoji, tblock, status, exp);

      const details = document.createElement("div");
      details.className = "details";

      const link = document.createElement("a");
      link.className = "link-btn";
      link.href = "https://acr.instructure.com/courses/411/assignments/" + lec.id;
      link.target = "_blank";
      link.rel = "noreferrer";
      link.textContent = "Open lecture â†’";

      const checkGroup = document.createElement("div");
      checkGroup.className = "check-group";

      const watchPill = createCheckPill("Watched", st.watched, (val) => {
        st.watched = val;
        applyGlow(card, st);
        saveState();
      });
      const attPill = createCheckPill("Attendance marked", st.attendance, (val) => {
        st.attendance = val;
        applyGlow(card, st);
        saveState();
      });
      checkGroup.append(watchPill, attPill);

      const ankiGroup = document.createElement("div");
      ankiGroup.className = "anki-group";
      const ankiLabel = document.createElement("span");
      ankiLabel.textContent = "Anki cards:";
      const ankiCount = document.createElement("span");
      ankiCount.className = "anki-count";
      ankiCount.textContent = st.anki;
      const minus = document.createElement("button");
      minus.type = "button";
      minus.className = "anki-btn";
      minus.textContent = "âˆ’";
      minus.addEventListener("click", (ev) => {
        ev.stopPropagation();
        st.anki = Math.max(0, st.anki - 1);
        ankiCount.textContent = st.anki;
        applyGlow(card, st);
        saveState();
      });
      const plus = document.createElement("button");
      plus.type = "button";
      plus.className = "anki-btn";
      plus.textContent = "+";
      plus.addEventListener("click", (ev) => {
        ev.stopPropagation();
        st.anki = st.anki + 1;
        ankiCount.textContent = st.anki;
        applyGlow(card, st);
        saveState();
      });
      const ten = document.createElement("button");
      ten.type = "button";
      ten.className = "anki-btn large";
      ten.textContent = "set 10";
      ten.addEventListener("click", (ev) => {
        ev.stopPropagation();
        if (st.anki < 10) st.anki = 10;
        ankiCount.textContent = st.anki;
        applyGlow(card, st);
        saveState();
      });

      ankiGroup.append(ankiLabel, minus, ankiCount, plus, ten);

      details.append(link, checkGroup, ankiGroup);

      card.append(top, details);

      card.addEventListener("click", (ev) => {
        if (ev.target.tagName === "A" || ev.target.closest("button") || ev.target.closest("input")) return;
        st.expanded = !st.expanded;
        card.classList.toggle("expanded", st.expanded);
        card.querySelector(".expand-indicator").textContent = st.expanded ? "â–²" : "â–¼";
        saveState();
      });

      applyGlow(card, st);
      return card;
    }

    // render
    LECTURES.forEach(lec => {
      const c = buildCard(lec);
      listEl.appendChild(c);
    });

    function updateProgressBadge() {
      let done = 0;
      LECTURES.forEach(lec => {
        const st = state[lec.id];
        if (st && st.anki >= 10) done++;
      });
      document.getElementById("progress-badge").textContent = done + " / " + LECTURES.length + " complete";
    }

    // filters
    let currentFilter = "all";
    function filterList(filter) {
      currentFilter = filter;
      document.querySelectorAll(".filter-btn").forEach(btn => {
        btn.classList.toggle("active", btn.dataset.filter === filter);
      });
      document.querySelectorAll(".card").forEach(card => {
        const id = card.dataset.id;
        const st = state[id];
        let show = true;
        if (filter === "need-watch") {
          show = !(st && st.watched);
        } else if (filter === "need-cards") {
          show = !(st && st.anki >= 10);
        }
        card.style.display = show ? "" : "none";
      });
    }

    document.querySelectorAll(".filter-btn").forEach(btn => {
      btn.addEventListener("click", () => filterList(btn.dataset.filter));
    });

    // expand/collapse
    document.getElementById("expand-all").addEventListener("click", () => {
      LECTURES.forEach(lec => { state[lec.id].expanded = true; });
      document.querySelectorAll(".card").forEach(c => {
        c.classList.add("expanded");
        c.querySelector(".expand-indicator").textContent = "â–²";
      });
      saveState();
    });
    document.getElementById("collapse-all").addEventListener("click", () => {
      LECTURES.forEach(lec => { state[lec.id].expanded = false; });
      document.querySelectorAll(".card").forEach(c => {
        c.classList.remove("expanded");
        c.querySelector(".expand-indicator").textContent = "â–¼";
      });
      saveState();
    });

    // export / import
    document.getElementById("export-btn").addEventListener("click", () => {
      const blob = new Blob([JSON.stringify(state, null, 2)], {type: "application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "airp-self-paced-progress.json";
      a.click();
      URL.revokeObjectURL(url);
    });

    document.getElementById("import-file").addEventListener("change", (ev) => {
      const file = ev.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = (e) => {
        try {
          const imported = JSON.parse(e.target.result);
          LECTURES.forEach(lec => {
            if (imported[lec.id]) state[lec.id] = imported[lec.id];
          });
          // rebuild
          listEl.innerHTML = "";
          LECTURES.forEach(lec => listEl.appendChild(buildCard(lec)));
          filterList(currentFilter);
          saveState();
        } catch (err) {
          alert("Could not import file");
        }
      };
      reader.readAsText(file);
    });

    // init
    updateProgressBadge();
    filterList("all");
  </script>
</body>
</html>